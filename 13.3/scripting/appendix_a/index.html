
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Product documentation for RadView WebLOAD" name="description"/>
<link href="../using_asynchronous/" rel="prev"/>
<link href="../appendix_b/" rel="next"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.5.42" name="generator"/>
<title>Appendix A - Scripting Samples - WebLOAD Documentation</title>
<link href="../../assets/stylesheets/main.0253249f.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#appendix-a-scripting-samples">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<div data-md-color-scheme="default" data-md-component="outdated" hidden="">
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="WebLOAD Documentation" class="md-header__button md-logo" data-md-component="logo" href="../.." title="WebLOAD Documentation">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            WebLOAD Documentation
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Appendix A - Scripting Samples
            
          </span>
</div>
</div>
</div>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
        
  
    
  
  Home

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../quickstart/">
        
  
    
  
  Quick Start

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../recorder/introduction/">
          
  
  Recorder

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../introduction/">
          
  
  Scripting

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../console/introduction/">
          
  
  Console

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../dashboard/introduction/">
          
  
  Dashboard

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../automation/introduction/">
          
  
  Automation

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../javascript/introduction/">
          
  
  JavaScript Reference

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../analytics/introduction/">
          
  
  Analytics

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../installation/">
        
  
    
  
  Installation

      </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="WebLOAD Documentation" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="WebLOAD Documentation">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    WebLOAD Documentation
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Home
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../quickstart/">
<span class="md-ellipsis">
    Quick Start
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    Recorder
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            Recorder
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../recorder/introduction/">
<span class="md-ellipsis">
    Introduction
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recorder/overview/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recorder/before_you_begin/">
<span class="md-ellipsis">
    Before you Begin
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recorder/quick_start/">
<span class="md-ellipsis">
    QuickStart
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recorder/recording_scripts/">
<span class="md-ellipsis">
    Recording Scripts
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recorder/editing_scripts/">
<span class="md-ellipsis">
    Editing Scripts
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recorder/correlating_scripts/">
<span class="md-ellipsis">
    Correlating Scripts
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recorder/running_debugging_scripts/">
<span class="md-ellipsis">
    Running and Debugging Scripts
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recorder/working_with_git/">
<span class="md-ellipsis">
    Working with GIT
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recorder/configuring_recorder_options/">
<span class="md-ellipsis">
    Configuring the WebLOAD Recorder Options
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recorder/appendix_a/">
<span class="md-ellipsis">
    Appendix A - The WebLOAD Recorder Toolbox Set
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recorder/appendix_b/">
<span class="md-ellipsis">
    Appendix B - WebLOAD Recorder File Types
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recorder/appendix_c/">
<span class="md-ellipsis">
    Appendix C - Launching WebLOAD Recorder
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recorder/appendix_d/">
<span class="md-ellipsis">
    Appendix D - Converting Certificate Files
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recorder/appendix_e/">
<span class="md-ellipsis">
    Appendix E - Recording Mobile Applications
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recorder/appendix_f/">
<span class="md-ellipsis">
    Appendix F - Integrating with Perfecto Mobile
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recorder/appendix_g/">
<span class="md-ellipsis">
    Appendix G - Selenium Integration
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recorder/appendix_h/">
<span class="md-ellipsis">
    Appendix H - Glossary
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
<span class="md-ellipsis">
    Scripting
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Scripting
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../introduction/">
<span class="md-ellipsis">
    Introduction
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../programming_your_javascript/">
<span class="md-ellipsis">
    Programming your JavaScript Script
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../advanced_javascript_features/">
<span class="md-ellipsis">
    Advanced JavaScript Script Features
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../working_with_http/">
<span class="md-ellipsis">
    Working with HTTP Protocol
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../using_asynchronous/">
<span class="md-ellipsis">
    Using Asynchronous Requests
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Appendix A - Scripting Samples
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Appendix A - Scripting Samples
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#scripting-sample-of-a-basic-recording">
<span class="md-ellipsis">
      Scripting Sample of a Basic Recording
    </span>
</a>
<nav aria-label="Scripting Sample of a Basic Recording" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#what-the-script-does">
<span class="md-ellipsis">
      What the Script Does
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-create-the-script">
<span class="md-ellipsis">
      How to Create the Script
    </span>
</a>
<nav aria-label="How to Create the Script" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#step-1-starting-to-record-the-script">
<span class="md-ellipsis">
      Step 1 – Starting to Record the script
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-2-logging-in-to-the-site">
<span class="md-ellipsis">
      Step 2 – Logging in to the Site
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-3-purchasing-a-product">
<span class="md-ellipsis">
      Step 3 – Purchasing a Product
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-4-saving-the-script">
<span class="md-ellipsis">
      Step 4 – Saving the script
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-full-script-script-1-basic-recording-script">
<span class="md-ellipsis">
      The Full script: script 1-Basic Recording script
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#scripting-sample-using-ajax-and-web-services">
<span class="md-ellipsis">
      Scripting Sample Using AJAX and Web Services
    </span>
</a>
<nav aria-label="Scripting Sample Using AJAX and Web Services" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#what-the-script-does_1">
<span class="md-ellipsis">
      What the Script Does
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-create-the-script_1">
<span class="md-ellipsis">
      How to Create the Script
    </span>
</a>
<nav aria-label="How to Create the Script" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#step-1-entering-credit-card-information-and-checking-out">
<span class="md-ellipsis">
      Step 1 – Entering Credit Card Information and Checking Out
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-2-adding-the-results-parameter-and-resultparser-function">
<span class="md-ellipsis">
      Step 2 – Adding the Results Parameter and ResultParser Function
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-3-creating-the-external-login-javascript-file">
<span class="md-ellipsis">
      Step 3 – Creating the External Login JavaScript File
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-4-including-and-using-the-external-file-in-the-script">
<span class="md-ellipsis">
      Step 4 – Including and Using the External File in the script
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-full-script-script-4-ajax-and-web-services">
<span class="md-ellipsis">
      The Full script: script 4-AJAX and Web Services
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#scripting-sample-using-ajax-and-json-to-validate-a-web-server-response">
<span class="md-ellipsis">
      Scripting Sample Using AJAX and JSON to Validate a Web Server Response
    </span>
</a>
<nav aria-label="Scripting Sample Using AJAX and JSON to Validate a Web Server Response" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#what-the-script-does_2">
<span class="md-ellipsis">
      What the Script Does
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-the-script-works">
<span class="md-ellipsis">
      How the Script Works
    </span>
</a>
<nav aria-label="How the Script Works" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#step-1-recording-ajax-calls-in-the-script">
<span class="md-ellipsis">
      Step 1 – Recording AJAX Calls in the script
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-2-parsing-the-json-response">
<span class="md-ellipsis">
      Step 2 – Parsing the JSON Response
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-3-displaying-json-information-during-runtime">
<span class="md-ellipsis">
      Step 3 – Displaying JSON Information During Runtime
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-full-script-script-5-ajax-and-json">
<span class="md-ellipsis">
      The Full script: script 5-AJAX and JSON
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../appendix_b/">
<span class="md-ellipsis">
    Appendix B - LiveConnect Overview
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    Console
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            Console
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/introduction/">
<span class="md-ellipsis">
    Introduction
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/introducing_webload/">
<span class="md-ellipsis">
    Introducing WebLOAD
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/getting_started/">
<span class="md-ellipsis">
    Getting Started
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/quickstart/">
<span class="md-ellipsis">
    Quick Start
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/console_features/">
<span class="md-ellipsis">
    Console Features
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/create_load_templates/">
<span class="md-ellipsis">
    Creating Load Templates
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/plan_test_session/">
<span class="md-ellipsis">
    Planning a Test Session
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/connect_webrm/">
<span class="md-ellipsis">
    Connecting to WebRM
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/manage_load_templates_sessions/">
<span class="md-ellipsis">
    Managing Load Templates and Load Sessions
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/create_template_wizard/">
<span class="md-ellipsis">
    Creating Load Templates with the WebLOAD Wizard
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/create_load_test_goal/">
<span class="md-ellipsis">
    Creating Load Templates with Goal-Oriented Test
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/config_load_template/">
<span class="md-ellipsis">
    Configuring a Load Template Manually
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/set_global_opt/">
<span class="md-ellipsis">
    Setting Global Options
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/set_script_options/">
<span class="md-ellipsis">
    Setting Script Options
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/func_verifi_test/">
<span class="md-ellipsis">
    Functional Verification Testing
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/run_test_analyze_results/">
<span class="md-ellipsis">
    Running Tests and Analyzing  Test Results
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/running_a_load_session/">
<span class="md-ellipsis">
    Running a Load Session
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/working_with_git/">
<span class="md-ellipsis">
    Working with Git
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/viewing_log_window/">
<span class="md-ellipsis">
    Viewing the Log Window
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/console_performance_reports/">
<span class="md-ellipsis">
    WebLOAD Console Performance Reports
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/statistics_reports/">
<span class="md-ellipsis">
    WebLOAD Statistics Reports
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/data_drilling_reports/">
<span class="md-ellipsis">
    Data Drilling Reports
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/export_performance_reports/">
<span class="md-ellipsis">
    Exporting Performance Reports
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/performance_measurements_manager/">
<span class="md-ellipsis">
    Performance Measurements Manager
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/cloud/">
<span class="md-ellipsis">
    Working with Cloud accounts
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/appendix_a/">
<span class="md-ellipsis">
    Appendix A - Integrating with AppDynamics
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/appendix_b/">
<span class="md-ellipsis">
    Appendix B - Integrating with Dynatrace
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/appendix_c/">
<span class="md-ellipsis">
    Appendix C - Integrating with Nagios
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/appendix_d/">
<span class="md-ellipsis">
    Appendix D - Integrating with New Relic
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/appendix_e/">
<span class="md-ellipsis">
    Appendix E - WebLOAD Console Error Messages
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/appendix_f/">
<span class="md-ellipsis">
    Appendix F - Reference Materials
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../console/appendix_g/">
<span class="md-ellipsis">
    Appendix G - Glossary
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
<span class="md-ellipsis">
    Dashboard
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            Dashboard
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../dashboard/introduction/">
<span class="md-ellipsis">
    Introduction
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dashboard/installation/">
<span class="md-ellipsis">
    Installation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dashboard/getting_started/">
<span class="md-ellipsis">
    Getting Started
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dashboard/manage_tests/">
<span class="md-ellipsis">
    Managing Test
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dashboard/manage_sessions/">
<span class="md-ellipsis">
    Managing Sessions
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dashboard/managing_resources/">
<span class="md-ellipsis">
    Managing Resources
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dashboard/using_dashboards/">
<span class="md-ellipsis">
    Using Dashboards
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dashboard/customizing_dashboard/">
<span class="md-ellipsis">
    Customizing a Dashboard
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dashboard/managing_dashboards/">
<span class="md-ellipsis">
    Managing Dashboards
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dashboard/sharing_dashboards/">
<span class="md-ellipsis">
    Sharing a Dashboard or Panel
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dashboard/creating_playlist/">
<span class="md-ellipsis">
    Creating and Playing a Playlist
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dashboard/managing_load_generators/">
<span class="md-ellipsis">
    Managing Load Generators
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dashboard/managing_organizations/">
<span class="md-ellipsis">
    Managing Organizations, Users, and Admins
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dashboard/global_lab_load_generators/">
<span class="md-ellipsis">
    Global Lab Load Generators
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dashboard/rest_api/">
<span class="md-ellipsis">
    Using the REST API
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dashboard/appendix_a/">
<span class="md-ellipsis">
    Appendix A - Editing WebLOAD Dashboard Configuration
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
<span class="md-ellipsis">
    Automation
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
            Automation
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../automation/introduction/">
<span class="md-ellipsis">
    Introduction
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../automation/overview/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../automation/webload_cli/">
<span class="md-ellipsis">
    Running WebLOAD from the Command Line
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../automation/webload_jenkins/">
<span class="md-ellipsis">
    Running WebLOAD in Jenkins
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../automation/webload_openapi/">
<span class="md-ellipsis">
    Running WebLOAD Using REST API
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
<span class="md-ellipsis">
    JavaScript Reference
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_8_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_8">
<span class="md-nav__icon md-icon"></span>
            JavaScript Reference
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../javascript/introduction/">
<span class="md-ellipsis">
    Introduction
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../javascript/intro_java_scripts/">
<span class="md-ellipsis">
    Introduction to JavaScript
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../javascript/using_javascript_ref/">
<span class="md-ellipsis">
    Using the WebLOAD JavaScript Reference
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../javascript/actions_objects_functions/">
<span class="md-ellipsis">
    WebLOAD Actions, Objects, and Functions
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../javascript/internet_protocol/">
<span class="md-ellipsis">
    WebLOAD Internet Protocols Reference
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../javascript/xmlparser/">
<span class="md-ellipsis">
    XML Parser Object
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../javascript/websocket_object/">
<span class="md-ellipsis">
    WebSocket Object
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../javascript/js_helper_funcs/">
<span class="md-ellipsis">
    JavaScript Helper Functions
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../javascript/appendix_a/">
<span class="md-ellipsis">
    Appendix A - WebLOAD-supported SSL Protocol Reference
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../javascript/appendix_b/">
<span class="md-ellipsis">
    Appendix B - WebLOAD-supported XML DOM Interfaces
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../javascript/appendix_c/">
<span class="md-ellipsis">
    Appendix C - HTTP Protocol Status Messages
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../javascript/appendix_d/">
<span class="md-ellipsis">
    Appendix D - WebLOAD-supported Character Sets
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../javascript/appendix_e/">
<span class="md-ellipsis">
    Appendix E - Glossary
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_9" type="checkbox"/>
<label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
<span class="md-ellipsis">
    Analytics
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_9_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_9">
<span class="md-nav__icon md-icon"></span>
            Analytics
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../analytics/introduction/">
<span class="md-ellipsis">
    Introduction
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../analytics/overview/">
<span class="md-ellipsis">
    WebLOAD Analytics System Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../analytics/getting_started/">
<span class="md-ellipsis">
    Getting Started
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../analytics/generating_charts/">
<span class="md-ellipsis">
    Generating Charts
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../analytics/changing_chart_settings/">
<span class="md-ellipsis">
    Changing Chart Settings
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../analytics/generating_reports/">
<span class="md-ellipsis">
    Generating Reports
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../analytics/load_sessions/">
<span class="md-ellipsis">
    Working with Load Sessions
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../analytics/templates/">
<span class="md-ellipsis">
    Working with Templates
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../analytics/portfolios/">
<span class="md-ellipsis">
    Working with Portfolios
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../analytics/defining_preferences/">
<span class="md-ellipsis">
    Defining Your Preferences
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../analytics/appendix_a/">
<span class="md-ellipsis">
    Appendix A. WebLOAD Analytics File System Structure
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../analytics/appendix_b/">
<span class="md-ellipsis">
    Appendix B. Understanding the Statistics
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../analytics/appendix_c/">
<span class="md-ellipsis">
    Appendix C. Running Analytics in Command Line Mode
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../analytics/appendix_d/">
<span class="md-ellipsis">
    Appendix D. Understanding the Templates
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../analytics/glossary/">
<span class="md-ellipsis">
    Appendix E. Glossary
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../installation/">
<span class="md-ellipsis">
    Installation
  </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#scripting-sample-of-a-basic-recording">
<span class="md-ellipsis">
      Scripting Sample of a Basic Recording
    </span>
</a>
<nav aria-label="Scripting Sample of a Basic Recording" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#what-the-script-does">
<span class="md-ellipsis">
      What the Script Does
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-create-the-script">
<span class="md-ellipsis">
      How to Create the Script
    </span>
</a>
<nav aria-label="How to Create the Script" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#step-1-starting-to-record-the-script">
<span class="md-ellipsis">
      Step 1 – Starting to Record the script
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-2-logging-in-to-the-site">
<span class="md-ellipsis">
      Step 2 – Logging in to the Site
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-3-purchasing-a-product">
<span class="md-ellipsis">
      Step 3 – Purchasing a Product
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-4-saving-the-script">
<span class="md-ellipsis">
      Step 4 – Saving the script
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-full-script-script-1-basic-recording-script">
<span class="md-ellipsis">
      The Full script: script 1-Basic Recording script
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#scripting-sample-using-ajax-and-web-services">
<span class="md-ellipsis">
      Scripting Sample Using AJAX and Web Services
    </span>
</a>
<nav aria-label="Scripting Sample Using AJAX and Web Services" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#what-the-script-does_1">
<span class="md-ellipsis">
      What the Script Does
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-to-create-the-script_1">
<span class="md-ellipsis">
      How to Create the Script
    </span>
</a>
<nav aria-label="How to Create the Script" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#step-1-entering-credit-card-information-and-checking-out">
<span class="md-ellipsis">
      Step 1 – Entering Credit Card Information and Checking Out
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-2-adding-the-results-parameter-and-resultparser-function">
<span class="md-ellipsis">
      Step 2 – Adding the Results Parameter and ResultParser Function
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-3-creating-the-external-login-javascript-file">
<span class="md-ellipsis">
      Step 3 – Creating the External Login JavaScript File
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-4-including-and-using-the-external-file-in-the-script">
<span class="md-ellipsis">
      Step 4 – Including and Using the External File in the script
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-full-script-script-4-ajax-and-web-services">
<span class="md-ellipsis">
      The Full script: script 4-AJAX and Web Services
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#scripting-sample-using-ajax-and-json-to-validate-a-web-server-response">
<span class="md-ellipsis">
      Scripting Sample Using AJAX and JSON to Validate a Web Server Response
    </span>
</a>
<nav aria-label="Scripting Sample Using AJAX and JSON to Validate a Web Server Response" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#what-the-script-does_2">
<span class="md-ellipsis">
      What the Script Does
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#how-the-script-works">
<span class="md-ellipsis">
      How the Script Works
    </span>
</a>
<nav aria-label="How the Script Works" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#step-1-recording-ajax-calls-in-the-script">
<span class="md-ellipsis">
      Step 1 – Recording AJAX Calls in the script
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-2-parsing-the-json-response">
<span class="md-ellipsis">
      Step 2 – Parsing the JSON Response
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-3-displaying-json-information-during-runtime">
<span class="md-ellipsis">
      Step 3 – Displaying JSON Information During Runtime
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-full-script-script-5-ajax-and-json">
<span class="md-ellipsis">
      The Full script: script 5-AJAX and JSON
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="appendix-a-scripting-samples">Appendix A: Scripting Samples</h1>
<p>This chapter provides sample scripts which you can adapt to your own scripts. Each scripting sample demonstrates different features that can be performed by editing your script’s script.</p>
<p>The following scripting samples are provided:</p>
<ul>
<li>
<p>Basic Recording</p>
</li>
<li>
<p>Correlation</p>
</li>
<li>
<p>Parameterizing a script</p>
</li>
<li>
<p>Using AJAX and Web services</p>
</li>
<li>
<p>Using AJAX and JSON</p>
</li>
</ul>
<h2 id="scripting-sample-of-a-basic-recording">Scripting Sample of a Basic Recording</h2>
<p>The sample script in this section demonstrates how a basic script is recorded. This script is used as a basis for the scripts that appear in the following sections.</p>
<h3 id="what-the-script-does">What the Script Does</h3>
<ul>
<li>Records user actions in the website. This is done by recording the HTTP traffic between the browser and the Web server.</li>
<li>Records Html form data sent from the browser.</li>
<li>Records the <code>Get()</code> and <code>Post()</code> methods.</li>
</ul>
<h3 id="how-to-create-the-script">How to Create the Script</h3>
<p>The basic script is created by starting to record in the WebLOAD Recorder, browsing through the <a href="http://www.webloadmpstore.com/">www.webloadmpstore.com </a>website, stopping the recording, and saving the script.</p>
<h4 id="step-1-starting-to-record-the-script">Step 1 – Starting to Record the script</h4>
<ol>
<li>In WebLOAD Recorder open a new script.</li>
<li>Click    <img alt="" src="../../images/script_guide_119.png"/> to start recording.</li>
<li>Browse to <a href="http://www.webloadmpstore.com/">www.webloadmpstore.com </a>in the browser that opens. The following script describing your action appears in the script.</li>
</ol>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nx">wlGlobals</span><span class="p">.</span><span class="nx">GetFrames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="nx">wlGlobals</span><span class="p">.</span><span class="nx">UserAgent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko"</span>
</span><span id="__span-0-3"><a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"DNT"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1"</span><span class="w"> </span>
</span><span id="__span-0-4"><a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"http://www.webloadmpstore.com/"</span><span class="p">)</span>
</span><span id="__span-0-5"><a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="nx">Sleep</span><span class="p">(</span><span class="mf">9094</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="step-2-logging-in-to-the-site">Step 2 – Logging in to the Site</h4>
<ol>
<li>
<p>Click <strong>Login</strong> in the webloadmpstore website and the Login page appears. The script for this action is as follows:</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-1-1"><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"http://www.webloadmpstore.com/"</span>
</span><span id="__span-1-2"><a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"http://www.webloadmpstore.com/login.php"</span><span class="p">)</span>
</span><span id="__span-1-3"><a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a>
</span><span id="__span-1-4"><a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="nx">Sleep</span><span class="p">(</span><span class="mf">7704</span><span class="p">)</span>
</span></code></pre></div>
</li>
<li>
<p>In the username and password fields, enter <code>demo-username</code> and <code>demo-password</code> to log in to the website.</p>
<p>WebLOAD Recorder records the login action and simulates a script containing the username and password that you entered in the login page.</p>
</li>
</ol>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-2-1"><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"http://www.webloadmpstore.com/login.php"</span>
</span><span id="__span-2-2"><a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">ContentType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"application/x-www-form-urlencoded"</span><span class="w"> </span>
</span><span id="__span-2-3"><a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"login"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"demo"</span><span class="w"> </span>
</span><span id="__span-2-4"><a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"password"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"demo"</span>
</span><span id="__span-2-5"><a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"sessionID"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"webloadmpstore.62.90.23.122.ae97bc7877d7bd4ebcb64c4c0e21ba1c"</span>
</span><span id="__span-2-6"><a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"event"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"login"</span><span class="w"> </span>
</span><span id="__span-2-7"><a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"Submit"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Login"</span><span class="w"> </span>
</span><span id="__span-2-8"><a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Post</span><span class="p">(</span><span class="s2">"http://www.webloadmpstore.com/login.php"</span><span class="p">)</span>
</span><span id="__span-2-9"><a href="#__codelineno-2-9" id="__codelineno-2-9" name="__codelineno-2-9"></a>
</span><span id="__span-2-10"><a href="#__codelineno-2-10" id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="nx">Sleep</span><span class="p">(</span><span class="mf">3015</span><span class="p">)</span>
</span></code></pre></div>
<p>The site approves your login information and the WebLOAD MP Store home page appears.</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-3-1"><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"http://www.webloadmpstore.com/index.php"</span><span class="p">)</span><span class="w"> </span>
</span><span id="__span-3-2"><a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="nx">Sleep</span><span class="p">(</span><span class="mf">5282</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="step-3-purchasing-a-product">Step 3 – Purchasing a Product</h4>
<ol>
<li>
<p>From the product page, click <strong>Debugging and Handling Dynamic Data</strong> to view the product’s additional details. A page with the product description for Debugging and Handling Dynamic Data appears.</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-4-1"><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
</span><span id="__span-4-2"><a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="s2">"http://www.webloadmpstore.com/index.php"</span>
</span><span id="__span-4-3"><a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"id"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1"</span><span class="w"> </span>
</span><span id="__span-4-4"><a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"&lt;http://www.webloadmpstore.com/product.php"</span><span class="p">)</span>
</span><span id="__span-4-5"><a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a>
</span><span id="__span-4-6"><a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="nx">Sleep</span><span class="p">(</span><span class="mf">4984</span><span class="p">)</span>
</span></code></pre></div>
</li>
<li>
<p>Click <strong>Add to Cart</strong> to purchase the product.</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-5-1"><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
</span><span id="__span-5-2"><a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="s2">"http://www.webloadmpstore.com/product.php?id=1"</span>
</span><span id="__span-5-3"><a href="#__codelineno-5-3" id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"event"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"addproduct"</span><span class="w"> </span>
</span><span id="__span-5-4"><a href="#__codelineno-5-4" id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"id"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1"</span>
</span><span id="__span-5-5"><a href="#__codelineno-5-5" id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"http://www.webloadmpstore.com/cart.php"</span><span class="p">)</span>
</span></code></pre></div>
</li>
</ol>
<h4 id="step-4-saving-the-script">Step 4 – Saving the script</h4>
<ol>
<li>In WebLOAD Recorder, click to stop recording the script.</li>
<li>Select <strong>File &gt; Save As</strong> to save the script. The Save As dialog box appears.</li>
<li>In the Save As dialog box browse to the following location: <code>D:\\Radview\\&lt;Sample scripts folder&gt;\\ script 1-Basic Recording script.wlp</code></li>
<li>Click <strong>Save</strong>.</li>
</ol>
<h3 id="the-full-script-script-1-basic-recording-script">The Full script: script 1-Basic Recording script</h3>
<blockquote>
<p><strong>Note:</strong> The WLIDE – URL comments throughout the script are modified to give the Agenda nodes meaningful names.</p>
</blockquote>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-6-1"><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="cm">/***** WLIDE - URL : Open webloadmpstore home page - ID:2 *****/</span><span class="w"> </span>
</span><span id="__span-6-2"><a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="nx">wlGlobals</span><span class="p">.</span><span class="nx">GetFrames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span>
</span><span id="__span-6-3"><a href="#__codelineno-6-3" id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"http://www.webloadmpstore.com/"</span><span class="p">)</span>
</span><span id="__span-6-4"><a href="#__codelineno-6-4" id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-6-5"><a href="#__codelineno-6-5" id="__codelineno-6-5" name="__codelineno-6-5"></a>
</span><span id="__span-6-6"><a href="#__codelineno-6-6" id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="cm">/***** WLIDE - Sleep - ID:3 *****/</span><span class="w"> </span>
</span><span id="__span-6-7"><a href="#__codelineno-6-7" id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="nx">Sleep</span><span class="p">(</span><span class="mf">9094</span><span class="p">)</span>
</span><span id="__span-6-8"><a href="#__codelineno-6-8" id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-6-9"><a href="#__codelineno-6-9" id="__codelineno-6-9" name="__codelineno-6-9"></a>
</span><span id="__span-6-10"><a href="#__codelineno-6-10" id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="cm">/***** WLIDE - URL : Open login page - ID:4 *****/</span><span class="w"> </span><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"http://www.webloadmpstore.com/"</span><span class="w"> </span>
</span><span id="__span-6-11"><a href="#__codelineno-6-11" id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"http://www.webloadmpstore.com/login.php"</span><span class="p">)</span>
</span><span id="__span-6-12"><a href="#__codelineno-6-12" id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-6-13"><a href="#__codelineno-6-13" id="__codelineno-6-13" name="__codelineno-6-13"></a>
</span><span id="__span-6-14"><a href="#__codelineno-6-14" id="__codelineno-6-14" name="__codelineno-6-14"></a><span class="cm">/***** WLIDE - Sleep - ID:5 *****/</span><span class="w"> </span>
</span><span id="__span-6-15"><a href="#__codelineno-6-15" id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="nx">Sleep</span><span class="p">(</span><span class="mf">7704</span><span class="p">)</span>
</span><span id="__span-6-16"><a href="#__codelineno-6-16" id="__codelineno-6-16" name="__codelineno-6-16"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-6-17"><a href="#__codelineno-6-17" id="__codelineno-6-17" name="__codelineno-6-17"></a>
</span><span id="__span-6-18"><a href="#__codelineno-6-18" id="__codelineno-6-18" name="__codelineno-6-18"></a><span class="cm">/***** WLIDE - URL :Insert login and password - ID:6 *****/</span>
</span><span id="__span-6-19"><a href="#__codelineno-6-19" id="__codelineno-6-19" name="__codelineno-6-19"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"http://www.webloadmpstore.com/login.php"</span>
</span><span id="__span-6-20"><a href="#__codelineno-6-20" id="__codelineno-6-20" name="__codelineno-6-20"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">ContentType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"application/x-www-form-urlencoded"</span><span class="w"> </span>
</span><span id="__span-6-21"><a href="#__codelineno-6-21" id="__codelineno-6-21" name="__codelineno-6-21"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"login"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"demo"</span><span class="w"> </span>
</span><span id="__span-6-22"><a href="#__codelineno-6-22" id="__codelineno-6-22" name="__codelineno-6-22"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"password"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"demo"</span>
</span><span id="__span-6-23"><a href="#__codelineno-6-23" id="__codelineno-6-23" name="__codelineno-6-23"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"sessionID"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"webloadmpstore.62.90.23.122.ae97bc7877d7bd4ebcb64c4c0e21ba1c"</span>
</span><span id="__span-6-24"><a href="#__codelineno-6-24" id="__codelineno-6-24" name="__codelineno-6-24"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"event"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"login"</span><span class="w"> </span>
</span><span id="__span-6-25"><a href="#__codelineno-6-25" id="__codelineno-6-25" name="__codelineno-6-25"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"Submit"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Login"</span><span class="w"> </span>
</span><span id="__span-6-26"><a href="#__codelineno-6-26" id="__codelineno-6-26" name="__codelineno-6-26"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Post</span><span class="p">(</span><span class="s2">"http://www.webloadmpstore.com/login.php"</span><span class="p">)</span>
</span><span id="__span-6-27"><a href="#__codelineno-6-27" id="__codelineno-6-27" name="__codelineno-6-27"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-6-28"><a href="#__codelineno-6-28" id="__codelineno-6-28" name="__codelineno-6-28"></a>
</span><span id="__span-6-29"><a href="#__codelineno-6-29" id="__codelineno-6-29" name="__codelineno-6-29"></a><span class="cm">/***** WLIDE - Sleep - ID:7 *****/</span><span class="w"> </span>
</span><span id="__span-6-30"><a href="#__codelineno-6-30" id="__codelineno-6-30" name="__codelineno-6-30"></a><span class="nx">Sleep</span><span class="p">(</span><span class="mf">3015</span><span class="p">)</span>
</span><span id="__span-6-31"><a href="#__codelineno-6-31" id="__codelineno-6-31" name="__codelineno-6-31"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-6-32"><a href="#__codelineno-6-32" id="__codelineno-6-32" name="__codelineno-6-32"></a>
</span><span id="__span-6-33"><a href="#__codelineno-6-33" id="__codelineno-6-33" name="__codelineno-6-33"></a>
</span><span id="__span-6-34"><a href="#__codelineno-6-34" id="__codelineno-6-34" name="__codelineno-6-34"></a><span class="cm">/***** WLIDE - URL :http://www.webloadmpstore.com/index.php - ID:8 *****/</span>
</span><span id="__span-6-35"><a href="#__codelineno-6-35" id="__codelineno-6-35" name="__codelineno-6-35"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"http://www.webloadmpstore.com/index.php"</span><span class="p">)</span>
</span><span id="__span-6-36"><a href="#__codelineno-6-36" id="__codelineno-6-36" name="__codelineno-6-36"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-6-37"><a href="#__codelineno-6-37" id="__codelineno-6-37" name="__codelineno-6-37"></a>
</span><span id="__span-6-38"><a href="#__codelineno-6-38" id="__codelineno-6-38" name="__codelineno-6-38"></a><span class="cm">/***** WLIDE - Sleep - ID:9 *****/</span><span class="w"> </span>
</span><span id="__span-6-39"><a href="#__codelineno-6-39" id="__codelineno-6-39" name="__codelineno-6-39"></a><span class="nx">Sleep</span><span class="p">(</span><span class="mf">5282</span><span class="p">)</span>
</span><span id="__span-6-40"><a href="#__codelineno-6-40" id="__codelineno-6-40" name="__codelineno-6-40"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-6-41"><a href="#__codelineno-6-41" id="__codelineno-6-41" name="__codelineno-6-41"></a>
</span><span id="__span-6-42"><a href="#__codelineno-6-42" id="__codelineno-6-42" name="__codelineno-6-42"></a><span class="cm">/***** WLIDE - URL : Select show product details - ID:10 *****/</span>
</span><span id="__span-6-43"><a href="#__codelineno-6-43" id="__codelineno-6-43" name="__codelineno-6-43"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"http://www.webloadmpstore.com/index.php"</span>
</span><span id="__span-6-44"><a href="#__codelineno-6-44" id="__codelineno-6-44" name="__codelineno-6-44"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"id"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1"</span><span class="w"> </span>
</span><span id="__span-6-45"><a href="#__codelineno-6-45" id="__codelineno-6-45" name="__codelineno-6-45"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"http://www.webloadmpstore.com/product.php"</span><span class="p">)</span>
</span><span id="__span-6-46"><a href="#__codelineno-6-46" id="__codelineno-6-46" name="__codelineno-6-46"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-6-47"><a href="#__codelineno-6-47" id="__codelineno-6-47" name="__codelineno-6-47"></a>
</span><span id="__span-6-48"><a href="#__codelineno-6-48" id="__codelineno-6-48" name="__codelineno-6-48"></a><span class="cm">/***** WLIDE - Sleep - ID:11 *****/</span><span class="w"> </span>
</span><span id="__span-6-49"><a href="#__codelineno-6-49" id="__codelineno-6-49" name="__codelineno-6-49"></a><span class="nx">Sleep</span><span class="p">(</span><span class="mf">4984</span><span class="p">)</span>
</span><span id="__span-6-50"><a href="#__codelineno-6-50" id="__codelineno-6-50" name="__codelineno-6-50"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-6-51"><a href="#__codelineno-6-51" id="__codelineno-6-51" name="__codelineno-6-51"></a>
</span><span id="__span-6-52"><a href="#__codelineno-6-52" id="__codelineno-6-52" name="__codelineno-6-52"></a><span class="cm">/***** WLIDE - URL : Add to cart - ID:12 *****/</span>
</span><span id="__span-6-53"><a href="#__codelineno-6-53" id="__codelineno-6-53" name="__codelineno-6-53"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"http://www.webloadmpstore.com/product.php?id=1"</span>
</span><span id="__span-6-54"><a href="#__codelineno-6-54" id="__codelineno-6-54" name="__codelineno-6-54"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"event"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"addproduct"</span>
</span><span id="__span-6-55"><a href="#__codelineno-6-55" id="__codelineno-6-55" name="__codelineno-6-55"></a><span class="w"> </span><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"id"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1"</span><span class="w"> </span><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"http://www.webloadmpstore.com/cart.php"</span><span class="p">)</span>
</span><span id="__span-6-56"><a href="#__codelineno-6-56" id="__codelineno-6-56" name="__codelineno-6-56"></a><span class="c1">// END WLIDE</span>
</span></code></pre></div>
<h2 id="scripting-sample-using-ajax-and-web-services">Scripting Sample Using AJAX and Web Services</h2>
<p>WebLOAD supports automatic recording of AJAX calls into the test script, enabling debugging and full access to all request data (headers and body), both in the script and during runtime. WebLOAD supports various formats for the AJAX payload: XML, JSON, other text-based formats, and binary data.</p>
<p>Besides demonstrating the use of AJAX calls, this script demonstrates the use of functions and external files in the script.</p>
<p>Storing sections of the logic in a function enables you to reuse the same lines of code without duplications, making the script more modular. A function can be part of your main script file or can be stored in a separate, external JavaScript file. When storing the function in a separate file, the main script file includes the function so that it can be used within the script.</p>
<p>One of the main benefits of including files in the script, is to reduce the maintenance needed for the scripts. The same included file can be used in a number of scripts simply by adding the include command and calling the function in the script.</p>
<p>Using included files is also more efficient. When the information in the included file needs to be updated, the included file is the only place that needs to be modified and the whole script will be affected. Without using an included file, you would need to search for every place that the information is used and update the information manually.</p>
<h3 id="what-the-script-does_1">What the Script Does</h3>
<ul>
<li>Demonstrates how to record user actions in a website that is accessed on a secure server.</li>
<li>Demonstrates how WebLOAD supports AJAX and Web services.</li>
<li>Demonstrate how to validate a Web Service reply by parsing the XML content of its SOAP message.</li>
<li>Demonstrates how to modify a recorded script where a specific option is selected, so that the script can accept additional options during runtime.</li>
<li>Demonstrates adding a function to the script.</li>
<li>Demonstrates how to extract a login script to an external JavaScript file and then reuse the code in the script.</li>
</ul>
<h3 id="how-to-create-the-script_1">How to Create the Script</h3>
<p>In this script, you will record a webpage that is accessed on a secure server. Once the script is recorded, you will modify the script so that during runtime, an InfoMessage notifies you whether your credit card information has been validated. This is done by adding a function that uses a Web Service to check the validation of the credit card and a parameter to store the result of the function.</p>
<p>You will create a function to store the script of the login process. Then, you can extract the function to an external file, which enables you to create a generic scenario, instead of a specific case. The function checks the login information received from the site and determines whether the user’s login information is accurate. Although the login information was correct when the script was recorded, by modifying the script you can add additional scenarios to be accepted during runtime, such as, when the login information is incorrect.</p>
<p>This script also demonstrates WebLOAD’s support of AJAX and Web services. During the recording, when the credit card information is being validated, the WebLOAD Recorder records the Web service transactions that take place within the application.</p>
<h4 id="step-1-entering-credit-card-information-and-checking-out">Step 1 – Entering Credit Card Information and Checking Out</h4>
<ol>
<li>
<p>Open the script3-Parametrizing a script.</p>
</li>
<li>
<p>Open a browser, navigate to the Cart page, and copy the URL of the page.</p>
</li>
<li>
<p>In the WebLOAD Recorder, click <img alt="" src="../../images/script_guide_121.png"/> or select <strong>Record &gt; Start Record</strong> to start recording.</p>
</li>
<li>
<p>Paste the URL of the cart page in the browser that opens. The new script is appended to the end of the existing script.</p>
</li>
<li>
<p>In the cart page, click <strong>Checkout</strong>.
    The credit card information page appears. This page is an HTTPS page and is appended to the script as follows:</p>
<p><div class="language-javascript highlight"><pre><span></span><code><span id="__span-7-1"><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="nx">wlGlobals</span><span class="p">.</span><span class="nx">GetFrames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
</span><span id="__span-7-2"><a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a>
</span><span id="__span-7-3"><a href="#__codelineno-7-3" id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="s2">"http://www.webloadmpstore.com/cart.php?event=update&amp;id=2&amp;quantity=3"</span>
</span><span id="__span-7-4"><a href="#__codelineno-7-4" id="__codelineno-7-4" name="__codelineno-7-4"></a>
</span><span id="__span-7-5"><a href="#__codelineno-7-5" id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"https://www.webloadmpstore.com/checkout.php"</span><span class="p">)</span>
</span></code></pre></div>
1. In the credit card information page, enter your credit card information and click <strong>Done</strong>. The script is recorded as follows:</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-8-1"><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="nx">wlGlobals</span><span class="p">.</span><span class="nx">GetFrames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
</span><span id="__span-8-2"><a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"https://www.webloadmpstore.com/checkout.php"</span>
</span><span id="__span-8-3"><a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"wsdl"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"$WL$VOID$STRING$"</span>
</span><span id="__span-8-4"><a href="#__codelineno-8-4" id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"https://www.webloadmpstore.com/soap/server.php"</span><span class="p">)</span>
</span><span id="__span-8-5"><a href="#__codelineno-8-5" id="__codelineno-8-5" name="__codelineno-8-5"></a>
</span><span id="__span-8-6"><a href="#__codelineno-8-6" id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"https://www.webloadmpstore.com/checkout.php"</span>
</span><span id="__span-8-7"><a href="#__codelineno-8-7" id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Data</span><span class="p">[</span><span class="s2">"Type"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"text/xml; charset=utf-8"</span>
</span><span id="__span-8-8"><a href="#__codelineno-8-8" id="__codelineno-8-8" name="__codelineno-8-8"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Data</span><span class="p">[</span><span class="s2">"Value"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"&lt;?xml version=\"1.0\" </span>
</span><span id="__span-8-9"><a href="#__codelineno-8-9" id="__codelineno-8-9" name="__codelineno-8-9"></a><span class="s2">encoding=\"utf-8\"?&gt;&lt;soap:Envelope </span>
</span><span id="__span-8-10"><a href="#__codelineno-8-10" id="__codelineno-8-10" name="__codelineno-8-10"></a><span class="s2">xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" </span>
</span><span id="__span-8-11"><a href="#__codelineno-8-11" id="__codelineno-8-11" name="__codelineno-8-11"></a><span class="s2">xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" </span>
</span><span id="__span-8-12"><a href="#__codelineno-8-12" id="__codelineno-8-12" name="__codelineno-8-12"></a><span class="s2">xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"</span>
</span><span id="__span-8-13"><a href="#__codelineno-8-13" id="__codelineno-8-13" name="__codelineno-8-13"></a><span class="s2">&gt;&lt;soap:Body&gt;&lt;checkValidity </span>
</span><span id="__span-8-14"><a href="#__codelineno-8-14" id="__codelineno-8-14" name="__codelineno-8-14"></a><span class="s2">xmlns=\"http://example.org/CreditCardProcess\"&gt;&lt;strCardN </span>
</span><span id="__span-8-15"><a href="#__codelineno-8-15" id="__codelineno-8-15" name="__codelineno-8-15"></a><span class="s2">umber&gt;ABCD&lt;/strCardNumber&gt;&lt;strHolderID&gt;AB1234&lt;/strHolder </span>
</span><span id="__span-8-16"><a href="#__codelineno-8-16" id="__codelineno-8-16" name="__codelineno-8-16"></a><span class="s2">ID&gt;&lt;/checkValidity&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;"</span>
</span><span id="__span-8-17"><a href="#__codelineno-8-17" id="__codelineno-8-17" name="__codelineno-8-17"></a>
</span><span id="__span-8-18"><a href="#__codelineno-8-18" id="__codelineno-8-18" name="__codelineno-8-18"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Post</span><span class="p">(</span><span class="s2">"[ttps://www.webloadmpstore.com/soap/server.php"</span><span class="p">)</span>
</span><span id="__span-8-19"><a href="#__codelineno-8-19" id="__codelineno-8-19" name="__codelineno-8-19"></a>
</span><span id="__span-8-20"><a href="#__codelineno-8-20" id="__codelineno-8-20" name="__codelineno-8-20"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">ContentType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"application/x-www-form-urlencoded"</span><span class="w"> </span>
</span><span id="__span-8-21"><a href="#__codelineno-8-21" id="__codelineno-8-21" name="__codelineno-8-21"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"name"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Radview"</span><span class="w"> </span>
</span><span id="__span-8-22"><a href="#__codelineno-8-22" id="__codelineno-8-22" name="__codelineno-8-22"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"address"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Hamelacha 14"</span><span class="w"> </span>
</span><span id="__span-8-23"><a href="#__codelineno-8-23" id="__codelineno-8-23" name="__codelineno-8-23"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"shippingAddress"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Park Afek"</span><span class="w"> </span>
</span><span id="__span-8-24"><a href="#__codelineno-8-24" id="__codelineno-8-24" name="__codelineno-8-24"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"cardNumber"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ABCD"</span><span class="w"> </span>
</span><span id="__span-8-25"><a href="#__codelineno-8-25" id="__codelineno-8-25" name="__codelineno-8-25"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"idNumber"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"AB1234"</span><span class="w"> </span>
</span><span id="__span-8-26"><a href="#__codelineno-8-26" id="__codelineno-8-26" name="__codelineno-8-26"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"event"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"process"</span>
</span><span id="__span-8-27"><a href="#__codelineno-8-27" id="__codelineno-8-27" name="__codelineno-8-27"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Post</span><span class="p">(</span><span class="s2">"https://www.webloadmpstore.com/checkout.php"</span><span class="p">)</span>
</span></code></pre></div>
</li>
<li>
<p>In WebLOAD Recorder, click   <img alt="" src="../../images/script_guide_120.jpeg"/> to stop recording the script.</p>
</li>
</ol>
<h4 id="step-2-adding-the-results-parameter-and-resultparser-function">Step 2 – Adding the Results Parameter and ResultParser Function</h4>
<ol>
<li>
<p>Add a <code>results</code> parameter to the Validate Cred – Pass Node of the script.</p>
<p>The <code>results</code> parameter stores a value received from the resultParser function, which checks whether your credit card information is valid. The HTTP response containing the result of the credit card validation Web Service (<code>document.wlXmls[0]</code>) that is extracted from the script, is sent to the <code>resultParser</code> function.</p>
<p>The <code>results</code> parameter appears in the Validate Cred – Pass Node of the script as follows:</p>
<div class="language-xml highlight"><pre><span></span><code><span id="__span-9-1"><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a>wlHttp.Header["Referer"]<span class="w"> </span>=<span class="w"> </span>"https://www.webloadmpstore.com/checkout.php"
</span><span id="__span-9-2"><a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a>wlHttp.Data["Type"]<span class="w"> </span>=<span class="w"> </span>"text/xml;<span class="w"> </span>charset=utf-8"
</span><span id="__span-9-3"><a href="#__codelineno-9-3" id="__codelineno-9-3" name="__codelineno-9-3"></a>wlHttp.Data["Value"]<span class="w"> </span>=<span class="w"> </span>"<span class="cp">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;</span><span class="nt">&lt;soap:Envelope</span><span class="w"> </span>
</span><span id="__span-9-4"><a href="#__codelineno-9-4" id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="na">xmlns:xsi=</span><span class="s">\"http://www.w3.org/2001/XMLSchema-instance\"</span><span class="w"> </span>
</span><span id="__span-9-5"><a href="#__codelineno-9-5" id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="na">xmlns:xsd=</span><span class="s">\"http://www.w3.org/2001/XMLSchema\"</span><span class="w"> </span>
</span><span id="__span-9-6"><a href="#__codelineno-9-6" id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="na">xmlns:soap=</span><span class="s">\"http://schemas.xmlsoap.org/soap/envelope/\"</span>
</span><span id="__span-9-7"><a href="#__codelineno-9-7" id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="nt">&gt;&lt;soap:Body&gt;&lt;checkValidity</span><span class="w"> </span>
</span><span id="__span-9-8"><a href="#__codelineno-9-8" id="__codelineno-9-8" name="__codelineno-9-8"></a><span class="na">xmlns=</span><span class="s">\"http://example.org/CreditCardProcesss\"</span><span class="nt">&gt;&lt;strCardN</span><span class="w"> </span>
</span><span id="__span-9-9"><a href="#__codelineno-9-9" id="__codelineno-9-9" name="__codelineno-9-9"></a><span class="err">umber</span><span class="nt">&gt;</span>ABCD<span class="nt">&lt;strCardNumber&gt;&lt;strHolderID&gt;</span>AB1234<span class="err">&lt;</span>/strHolder<span class="w"> </span>
</span><span id="__span-9-10"><a href="#__codelineno-9-10" id="__codelineno-9-10" name="__codelineno-9-10"></a>ID&gt;<span class="nt">&lt;/checkValidity&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;</span>"
</span><span id="__span-9-11"><a href="#__codelineno-9-11" id="__codelineno-9-11" name="__codelineno-9-11"></a>
</span><span id="__span-9-12"><a href="#__codelineno-9-12" id="__codelineno-9-12" name="__codelineno-9-12"></a>wlHttp.Post("https://www.webloadmpstore.com/soap/server.php")
</span><span id="__span-9-13"><a href="#__codelineno-9-13" id="__codelineno-9-13" name="__codelineno-9-13"></a>
</span><span id="__span-9-14"><a href="#__codelineno-9-14" id="__codelineno-9-14" name="__codelineno-9-14"></a>results<span class="w"> </span>=<span class="w"> </span>resultParser(<span class="w"> </span>document.wlXmls[0]<span class="w"> </span>)
</span></code></pre></div>
</li>
<li>
<p>Create an infoMessage to notify you whether your credit card has been validated or not according to the result parameter value.</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-10-1"><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"https://www.webloadmpstore.com/checkout.php"</span>
</span><span id="__span-10-2"><a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Data</span><span class="p">[</span><span class="s2">"Type"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"text/xml; charset=utf-8"</span>
</span><span id="__span-10-3"><a href="#__codelineno-10-3" id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Data</span><span class="p">[</span><span class="s2">"Value"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;soap:Envelope </span>
</span><span id="__span-10-4"><a href="#__codelineno-10-4" id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="s2">xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" </span>
</span><span id="__span-10-5"><a href="#__codelineno-10-5" id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="s2">xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" </span>
</span><span id="__span-10-6"><a href="#__codelineno-10-6" id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="s2">xmlns:soap=\["</span><span class="nx">http</span><span class="o">:</span><span class="c1">//schemas.xmlsoap.org/soap/envelope/\&gt;&lt;soap:Body&gt;&lt;checkValidity </span>
</span><span id="__span-10-7"><a href="#__codelineno-10-7" id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="nx">xmlns</span><span class="o">=</span><span class="err">\</span><span class="s2">"http://example.org/CreditCardProcess\"&gt;&lt;strCardN </span>
</span><span id="__span-10-8"><a href="#__codelineno-10-8" id="__codelineno-10-8" name="__codelineno-10-8"></a><span class="s2">umber&gt;ABCD&lt;strCardNumber&gt;&lt;strHolderID&gt;AB1234&lt;/strHolder </span>
</span><span id="__span-10-9"><a href="#__codelineno-10-9" id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="s2">ID&gt;&lt;/checkValidity&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;"</span>
</span><span id="__span-10-10"><a href="#__codelineno-10-10" id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Post</span><span class="p">(</span><span class="s2">"https://www.webloadmpstore.com/soap/server.php"</span><span class="p">)</span>
</span><span id="__span-10-11"><a href="#__codelineno-10-11" id="__codelineno-10-11" name="__codelineno-10-11"></a>
</span><span id="__span-10-12"><a href="#__codelineno-10-12" id="__codelineno-10-12" name="__codelineno-10-12"></a><span class="nx">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">resultParser</span><span class="p">(</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">wlXmls</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
</span><span id="__span-10-13"><a href="#__codelineno-10-13" id="__codelineno-10-13" name="__codelineno-10-13"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">results</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"1"</span><span class="p">)</span>
</span><span id="__span-10-14"><a href="#__codelineno-10-14" id="__codelineno-10-14" name="__codelineno-10-14"></a><span class="nx">InfoMessage</span><span class="p">(</span><span class="s2">"Validation check return ‘Check OK’ like it should"</span><span class="p">)</span>
</span><span id="__span-10-15"><a href="#__codelineno-10-15" id="__codelineno-10-15" name="__codelineno-10-15"></a><span class="k">else</span>
</span><span id="__span-10-16"><a href="#__codelineno-10-16" id="__codelineno-10-16" name="__codelineno-10-16"></a><span class="nx">InfoMessage</span><span class="p">(</span><span class="s2">"Validation check is not working correctly"</span><span class="p">)</span>
</span></code></pre></div>
</li>
<li>
<p>Add the resultParser function to the script, which checks whether your credit card information is valid. The function retrieves the information from document.wlXmls[0] in the results parameter and uses the built-in WebLOAD XML DOM to parse and return XML data to the parameter.</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-11-1"><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">resultParser</span><span class="w"> </span><span class="p">(</span><span class="nx">doc</span><span class="p">)</span>
</span><span id="__span-11-2"><a href="#__codelineno-11-2" id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-3"><a href="#__codelineno-11-3" id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="w"> </span><span class="c1">//get ‘Result’ tags, we expect exactly one result:</span>
</span><span id="__span-11-4"><a href="#__codelineno-11-4" id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="w"> </span><span class="nx">ResultsElements</span><span class="w"> </span><span class="o">=</span>
</span><span id="__span-11-5"><a href="#__codelineno-11-5" id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="w"> </span><span class="nx">doc</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">"Result"</span><span class="p">)</span>
</span><span id="__span-11-6"><a href="#__codelineno-11-6" id="__codelineno-11-6" name="__codelineno-11-6"></a>
</span><span id="__span-11-7"><a href="#__codelineno-11-7" id="__codelineno-11-7" name="__codelineno-11-7"></a><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nx">ResultsElements</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-11-8"><a href="#__codelineno-11-8" id="__codelineno-11-8" name="__codelineno-11-8"></a><span class="w"> </span><span class="c1">// Verify only one element with that name exists</span>
</span><span id="__span-11-9"><a href="#__codelineno-11-9" id="__codelineno-11-9" name="__codelineno-11-9"></a><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="s2">"Expecting a single Result tag. received "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">ResultsElements</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"elements"</span>
</span><span id="__span-11-10"><a href="#__codelineno-11-10" id="__codelineno-11-10" name="__codelineno-11-10"></a>
</span><span id="__span-11-11"><a href="#__codelineno-11-11" id="__codelineno-11-11" name="__codelineno-11-11"></a><span class="w"> </span><span class="nx">ResultElm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ResultsElements</span><span class="p">.</span><span class="nx">item</span><span class="p">(</span><span class="mf">0</span><span class="p">)</span>
</span><span id="__span-11-12"><a href="#__codelineno-11-12" id="__codelineno-11-12" name="__codelineno-11-12"></a>
</span><span id="__span-11-13"><a href="#__codelineno-11-13" id="__codelineno-11-13" name="__codelineno-11-13"></a><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nx">ResultElm</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-11-14"><a href="#__codelineno-11-14" id="__codelineno-11-14" name="__codelineno-11-14"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span>
</span><span id="__span-11-15"><a href="#__codelineno-11-15" id="__codelineno-11-15" name="__codelineno-11-15"></a><span class="w"> </span><span class="k">else</span>
</span><span id="__span-11-16"><a href="#__codelineno-11-16" id="__codelineno-11-16" name="__codelineno-11-16"></a><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-17"><a href="#__codelineno-11-17" id="__codelineno-11-17" name="__codelineno-11-17"></a><span class="w">      </span><span class="nx">Result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ResultElm</span><span class="p">.</span><span class="nx">firstChild</span>
</span><span id="__span-11-18"><a href="#__codelineno-11-18" id="__codelineno-11-18" name="__codelineno-11-18"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">Result</span><span class="p">.</span><span class="nx">nodeValue</span>
</span><span id="__span-11-19"><a href="#__codelineno-11-19" id="__codelineno-11-19" name="__codelineno-11-19"></a><span class="w"> </span><span class="p">}</span>
</span><span id="__span-11-20"><a href="#__codelineno-11-20" id="__codelineno-11-20" name="__codelineno-11-20"></a><span class="p">}</span>
</span></code></pre></div>
</li>
</ol>
<h4 id="step-3-creating-the-external-login-javascript-file">Step 3 – Creating the External Login JavaScript File</h4>
<ol>
<li>
<p>Select the section of the script that is responsible for the login process.</p>
</li>
<li>
<p>Copy the script to a separate JavaScript file and save the file as login_js.js. The script in the login_js.js file is as follows:</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-12-1"><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">Login</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-2"><a href="#__codelineno-12-2" id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="w">  </span><span class="nx">strGlobalInputFileLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">GetLine</span><span class="p">(</span><span class="nx">InFile1</span><span class="p">,</span><span class="s2">","</span><span class="p">)</span><span class="w"> </span>
</span><span id="__span-12-3"><a href="#__codelineno-12-3" id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="w">  </span><span class="nx">user</span><span class="err">\</span><span class="nx">_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">strGlobalInputFileLine</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span>
</span><span id="__span-12-4"><a href="#__codelineno-12-4" id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="w">  </span><span class="nx">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">strGlobalInputFileLine</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span>
</span><span id="__span-12-5"><a href="#__codelineno-12-5" id="__codelineno-12-5" name="__codelineno-12-5"></a>
</span><span id="__span-12-6"><a href="#__codelineno-12-6" id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="w">  </span><span class="nx">wlGlobals</span><span class="p">.</span><span class="nx">GetFrames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span>
</span><span id="__span-12-7"><a href="#__codelineno-12-7" id="__codelineno-12-7" name="__codelineno-12-7"></a><span class="w">  </span><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"http://www.webloadmpstore.com/"</span><span class="p">)</span>
</span><span id="__span-12-8"><a href="#__codelineno-12-8" id="__codelineno-12-8" name="__codelineno-12-8"></a>
</span><span id="__span-12-9"><a href="#__codelineno-12-9" id="__codelineno-12-9" name="__codelineno-12-9"></a><span class="w">  </span><span class="nx">Sleep</span><span class="p">(</span><span class="mf">9094</span><span class="p">)</span>
</span><span id="__span-12-10"><a href="#__codelineno-12-10" id="__codelineno-12-10" name="__codelineno-12-10"></a>
</span><span id="__span-12-11"><a href="#__codelineno-12-11" id="__codelineno-12-11" name="__codelineno-12-11"></a><span class="w">  </span><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"http://www.webloadmpstore.com/"</span>
</span><span id="__span-12-12"><a href="#__codelineno-12-12" id="__codelineno-12-12" name="__codelineno-12-12"></a><span class="w">  </span><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"http://www.webloadmpstore.com/login.php"</span><span class="p">)</span><span class="w"> </span>
</span><span id="__span-12-13"><a href="#__codelineno-12-13" id="__codelineno-12-13" name="__codelineno-12-13"></a>
</span><span id="__span-12-14"><a href="#__codelineno-12-14" id="__codelineno-12-14" name="__codelineno-12-14"></a><span class="w">  </span><span class="nx">Sleep</span><span class="p">(</span><span class="mf">7704</span><span class="p">)</span>
</span><span id="__span-12-15"><a href="#__codelineno-12-15" id="__codelineno-12-15" name="__codelineno-12-15"></a>
</span><span id="__span-12-16"><a href="#__codelineno-12-16" id="__codelineno-12-16" name="__codelineno-12-16"></a><span class="w"> </span><span class="nx">session_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">forms</span><span class="p">[</span><span class="mf">1</span><span class="p">].</span><span class="nx">elements</span><span class="p">[</span><span class="mf">2</span><span class="p">].</span><span class="nx">value</span>
</span><span id="__span-12-17"><a href="#__codelineno-12-17" id="__codelineno-12-17" name="__codelineno-12-17"></a>
</span><span id="__span-12-18"><a href="#__codelineno-12-18" id="__codelineno-12-18" name="__codelineno-12-18"></a><span class="w"> </span><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"http://www.webloadmpstore.com/login.php"</span>
</span><span id="__span-12-19"><a href="#__codelineno-12-19" id="__codelineno-12-19" name="__codelineno-12-19"></a><span class="w"> </span><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">ContentType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"application/x-www-form-urlencoded"</span><span class="w"> </span>
</span><span id="__span-12-20"><a href="#__codelineno-12-20" id="__codelineno-12-20" name="__codelineno-12-20"></a><span class="w"> </span><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"login"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">user_name</span><span class="w"> </span>
</span><span id="__span-12-21"><a href="#__codelineno-12-21" id="__codelineno-12-21" name="__codelineno-12-21"></a><span class="w"> </span><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"password"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">password</span><span class="w"> </span>
</span><span id="__span-12-22"><a href="#__codelineno-12-22" id="__codelineno-12-22" name="__codelineno-12-22"></a><span class="w"> </span><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"sessionID"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">session_id</span><span class="w"> </span><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"event"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"login"</span><span class="w"> </span>
</span><span id="__span-12-23"><a href="#__codelineno-12-23" id="__codelineno-12-23" name="__codelineno-12-23"></a><span class="w"> </span><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"Submit"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Login"</span><span class="w"> </span>
</span><span id="__span-12-24"><a href="#__codelineno-12-24" id="__codelineno-12-24" name="__codelineno-12-24"></a><span class="w"> </span><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Post</span><span class="p">(</span><span class="s2">"http://www.webloadmpstore.com/login.php"</span><span class="p">)</span>
</span><span id="__span-12-25"><a href="#__codelineno-12-25" id="__codelineno-12-25" name="__codelineno-12-25"></a><span class="w"> </span><span class="p">}</span>
</span></code></pre></div>
</li>
</ol>
<h4 id="step-4-including-and-using-the-external-file-in-the-script">Step 4 – Including and Using the External File in the script</h4>
<ol>
<li>
<p>Include the external JavaScript file in the script by copying the following into the <code>InitAgenda()</code> function of the script:</p>
<p><code>IncludeFile("login\_js.js")</code></p>
</li>
<li>
<p>Drag the JavaScript object Building Block into the script.</p>
</li>
<li>
<p>Add the <code>rs</code> parameter that calls the login function from the included <code>login\_js.js file.</code></p>
<p><code>rs = Login()</code></p>
</li>
<li>
<p>Save the script as script 4–Ajax and Web services.</p>
</li>
</ol>
<h3 id="the-full-script-script-4-ajax-and-web-services">The Full script: script 4-AJAX and Web Services</h3>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-13-1"><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">InitAgenda</span><span class="p">()</span>
</span><span id="__span-13-2"><a href="#__codelineno-13-2" id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="p">{</span>
</span><span id="__span-13-3"><a href="#__codelineno-13-3" id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="nx">InFile1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">CopyFile</span><span class="p">(</span><span class="s2">"P:\\Supporting Tools\\Sample Scripts\\New\\InFile1.txt"</span><span class="p">)</span>
</span><span id="__span-13-4"><a href="#__codelineno-13-4" id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="nx">Open</span><span class="p">(</span><span class="nx">InFile1</span><span class="p">)</span><span class="w"> </span>
</span><span id="__span-13-5"><a href="#__codelineno-13-5" id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="nx">IncludeFile</span><span class="p">(</span><span class="s2">"login_js.js"</span><span class="p">)</span>
</span><span id="__span-13-6"><a href="#__codelineno-13-6" id="__codelineno-13-6" name="__codelineno-13-6"></a><span class="p">}</span>
</span><span id="__span-13-7"><a href="#__codelineno-13-7" id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="cm">/***** WLIDE -function resultParser - ID:33 *****/</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">resultParser</span><span class="w"> </span><span class="p">(</span><span class="nx">doc</span><span class="p">)</span>
</span><span id="__span-13-8"><a href="#__codelineno-13-8" id="__codelineno-13-8" name="__codelineno-13-8"></a><span class="p">{</span>
</span><span id="__span-13-9"><a href="#__codelineno-13-9" id="__codelineno-13-9" name="__codelineno-13-9"></a><span class="w">    </span><span class="c1">//get ‘Result’ tags, we expect exactly one result: </span>
</span><span id="__span-13-10"><a href="#__codelineno-13-10" id="__codelineno-13-10" name="__codelineno-13-10"></a><span class="w">    </span><span class="nx">ResultsElements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">doc</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">"Result"</span><span class="p">)</span>
</span><span id="__span-13-11"><a href="#__codelineno-13-11" id="__codelineno-13-11" name="__codelineno-13-11"></a>
</span><span id="__span-13-12"><a href="#__codelineno-13-12" id="__codelineno-13-12" name="__codelineno-13-12"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nx">ResultsElements</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-13-13"><a href="#__codelineno-13-13" id="__codelineno-13-13" name="__codelineno-13-13"></a><span class="w">    </span><span class="c1">// Verify only one element with that name exist</span>
</span><span id="__span-13-14"><a href="#__codelineno-13-14" id="__codelineno-13-14" name="__codelineno-13-14"></a><span class="w">       </span><span class="k">throw</span><span class="w"> </span><span class="s2">"Expecting a single Result tag. received "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">ResultsElements</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"elements"</span>
</span><span id="__span-13-15"><a href="#__codelineno-13-15" id="__codelineno-13-15" name="__codelineno-13-15"></a><span class="w">    </span><span class="nx">ResultElm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ResultsElements</span><span class="p">.</span><span class="nx">item</span><span class="p">(</span><span class="mf">0</span><span class="p">)</span>
</span><span id="__span-13-16"><a href="#__codelineno-13-16" id="__codelineno-13-16" name="__codelineno-13-16"></a>
</span><span id="__span-13-17"><a href="#__codelineno-13-17" id="__codelineno-13-17" name="__codelineno-13-17"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nx">ResultElm</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
</span><span id="__span-13-18"><a href="#__codelineno-13-18" id="__codelineno-13-18" name="__codelineno-13-18"></a><span class="w">       </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span>
</span><span id="__span-13-19"><a href="#__codelineno-13-19" id="__codelineno-13-19" name="__codelineno-13-19"></a><span class="w">    </span><span class="k">else</span>
</span><span id="__span-13-20"><a href="#__codelineno-13-20" id="__codelineno-13-20" name="__codelineno-13-20"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-13-21"><a href="#__codelineno-13-21" id="__codelineno-13-21" name="__codelineno-13-21"></a><span class="w">       </span><span class="nx">Result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">ResultElm</span><span class="p">.</span><span class="nx">firstChild</span><span class="w"> </span>
</span><span id="__span-13-22"><a href="#__codelineno-13-22" id="__codelineno-13-22" name="__codelineno-13-22"></a><span class="w">       </span><span class="k">return</span><span class="w"> </span><span class="nx">Result</span><span class="p">.</span><span class="nx">nodeValue</span>
</span><span id="__span-13-23"><a href="#__codelineno-13-23" id="__codelineno-13-23" name="__codelineno-13-23"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-13-24"><a href="#__codelineno-13-24" id="__codelineno-13-24" name="__codelineno-13-24"></a><span class="p">}</span>
</span><span id="__span-13-25"><a href="#__codelineno-13-25" id="__codelineno-13-25" name="__codelineno-13-25"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-13-26"><a href="#__codelineno-13-26" id="__codelineno-13-26" name="__codelineno-13-26"></a>
</span><span id="__span-13-27"><a href="#__codelineno-13-27" id="__codelineno-13-27" name="__codelineno-13-27"></a><span class="cm">/***** WLIDE - Login Function - ID:19 *****/</span><span class="w"> </span>
</span><span id="__span-13-28"><a href="#__codelineno-13-28" id="__codelineno-13-28" name="__codelineno-13-28"></a><span class="nx">rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Login</span><span class="p">()</span>
</span><span id="__span-13-29"><a href="#__codelineno-13-29" id="__codelineno-13-29" name="__codelineno-13-29"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-13-30"><a href="#__codelineno-13-30" id="__codelineno-13-30" name="__codelineno-13-30"></a>
</span><span id="__span-13-31"><a href="#__codelineno-13-31" id="__codelineno-13-31" name="__codelineno-13-31"></a><span class="cm">/***** WLIDE - Sleep - ID:7 *****/</span><span class="w"> </span>
</span><span id="__span-13-32"><a href="#__codelineno-13-32" id="__codelineno-13-32" name="__codelineno-13-32"></a><span class="nx">Sleep</span><span class="p">(</span><span class="mf">3015</span><span class="p">)</span>
</span><span id="__span-13-33"><a href="#__codelineno-13-33" id="__codelineno-13-33" name="__codelineno-13-33"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-13-34"><a href="#__codelineno-13-34" id="__codelineno-13-34" name="__codelineno-13-34"></a>
</span><span id="__span-13-35"><a href="#__codelineno-13-35" id="__codelineno-13-35" name="__codelineno-13-35"></a><span class="cm">/***** WLIDE - URL : http://www.webloadmpstore.com/index.php- ID:8 *****/</span>
</span><span id="__span-13-36"><a href="#__codelineno-13-36" id="__codelineno-13-36" name="__codelineno-13-36"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"http://www.webloadmpstore.com/index.php"</span><span class="p">)</span>
</span><span id="__span-13-37"><a href="#__codelineno-13-37" id="__codelineno-13-37" name="__codelineno-13-37"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-13-38"><a href="#__codelineno-13-38" id="__codelineno-13-38" name="__codelineno-13-38"></a>
</span><span id="__span-13-39"><a href="#__codelineno-13-39" id="__codelineno-13-39" name="__codelineno-13-39"></a><span class="cm">/***** WLIDE - Sleep - ID:9 *****/</span><span class="w"> </span>
</span><span id="__span-13-40"><a href="#__codelineno-13-40" id="__codelineno-13-40" name="__codelineno-13-40"></a><span class="nx">Sleep</span><span class="p">(</span><span class="mf">5282</span><span class="p">)</span>
</span><span id="__span-13-41"><a href="#__codelineno-13-41" id="__codelineno-13-41" name="__codelineno-13-41"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-13-42"><a href="#__codelineno-13-42" id="__codelineno-13-42" name="__codelineno-13-42"></a>
</span><span id="__span-13-43"><a href="#__codelineno-13-43" id="__codelineno-13-43" name="__codelineno-13-43"></a><span class="cm">/***** WLIDE - Parameterizing product ID and category number - ID:28 *****/</span>
</span><span id="__span-13-44"><a href="#__codelineno-13-44" id="__codelineno-13-44" name="__codelineno-13-44"></a>
</span><span id="__span-13-45"><a href="#__codelineno-13-45" id="__codelineno-13-45" name="__codelineno-13-45"></a><span class="nx">product_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">wlRand</span><span class="p">.</span><span class="nx">Range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="mf">9</span><span class="p">)</span><span class="w"> </span>
</span><span id="__span-13-46"><a href="#__codelineno-13-46" id="__codelineno-13-46" name="__codelineno-13-46"></a><span class="nx">quantity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">wlRand</span><span class="p">.</span><span class="nx">Range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="mf">12</span><span class="p">)</span>
</span><span id="__span-13-47"><a href="#__codelineno-13-47" id="__codelineno-13-47" name="__codelineno-13-47"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-13-48"><a href="#__codelineno-13-48" id="__codelineno-13-48" name="__codelineno-13-48"></a>
</span><span id="__span-13-49"><a href="#__codelineno-13-49" id="__codelineno-13-49" name="__codelineno-13-49"></a><span class="cm">/***** WLIDE - URL : Select show product details - ID:10 *****/</span>
</span><span id="__span-13-50"><a href="#__codelineno-13-50" id="__codelineno-13-50" name="__codelineno-13-50"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"http://www.webloadmpstore.com/index.php"</span>
</span><span id="__span-13-51"><a href="#__codelineno-13-51" id="__codelineno-13-51" name="__codelineno-13-51"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"id"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">product_id</span><span class="w"> </span>
</span><span id="__span-13-52"><a href="#__codelineno-13-52" id="__codelineno-13-52" name="__codelineno-13-52"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"http://www.webloadmpstore.com/product.php"</span><span class="p">)</span>
</span><span id="__span-13-53"><a href="#__codelineno-13-53" id="__codelineno-13-53" name="__codelineno-13-53"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-13-54"><a href="#__codelineno-13-54" id="__codelineno-13-54" name="__codelineno-13-54"></a>
</span><span id="__span-13-55"><a href="#__codelineno-13-55" id="__codelineno-13-55" name="__codelineno-13-55"></a><span class="cm">/***** WLIDE - Sleep - ID:11 *****/</span><span class="w"> </span>
</span><span id="__span-13-56"><a href="#__codelineno-13-56" id="__codelineno-13-56" name="__codelineno-13-56"></a><span class="nx">Sleep</span><span class="p">(</span><span class="mf">4984</span><span class="p">)</span>
</span><span id="__span-13-57"><a href="#__codelineno-13-57" id="__codelineno-13-57" name="__codelineno-13-57"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-13-58"><a href="#__codelineno-13-58" id="__codelineno-13-58" name="__codelineno-13-58"></a>
</span><span id="__span-13-59"><a href="#__codelineno-13-59" id="__codelineno-13-59" name="__codelineno-13-59"></a><span class="cm">/***** WLIDE - URL : Add to cart - ID:12 *****/</span>
</span><span id="__span-13-60"><a href="#__codelineno-13-60" id="__codelineno-13-60" name="__codelineno-13-60"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"http://www.webloadmpstore.com/product.php?id=product_id"</span>
</span><span id="__span-13-61"><a href="#__codelineno-13-61" id="__codelineno-13-61" name="__codelineno-13-61"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"event"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"addproduct"</span><span class="w"> </span>
</span><span id="__span-13-62"><a href="#__codelineno-13-62" id="__codelineno-13-62" name="__codelineno-13-62"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"id"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">product_id</span><span class="w"> </span>
</span><span id="__span-13-63"><a href="#__codelineno-13-63" id="__codelineno-13-63" name="__codelineno-13-63"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"http://www.webloadmpstore.com/cart.php"</span><span class="p">)</span>
</span><span id="__span-13-64"><a href="#__codelineno-13-64" id="__codelineno-13-64" name="__codelineno-13-64"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-13-65"><a href="#__codelineno-13-65" id="__codelineno-13-65" name="__codelineno-13-65"></a>
</span><span id="__span-13-66"><a href="#__codelineno-13-66" id="__codelineno-13-66" name="__codelineno-13-66"></a><span class="cm">/***** WLIDE - URL : Product quantity - ID:17 *****/</span><span class="w"> </span>
</span><span id="__span-13-67"><a href="#__codelineno-13-67" id="__codelineno-13-67" name="__codelineno-13-67"></a><span class="nx">wlGlobals</span><span class="p">.</span><span class="nx">GetFrames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
</span><span id="__span-13-68"><a href="#__codelineno-13-68" id="__codelineno-13-68" name="__codelineno-13-68"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"event"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"update"</span><span class="w"> </span>
</span><span id="__span-13-69"><a href="#__codelineno-13-69" id="__codelineno-13-69" name="__codelineno-13-69"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"id"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">product_id</span><span class="w"> </span>
</span><span id="__span-13-70"><a href="#__codelineno-13-70" id="__codelineno-13-70" name="__codelineno-13-70"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"quantity"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">quantity</span><span class="w"> </span>
</span><span id="__span-13-71"><a href="#__codelineno-13-71" id="__codelineno-13-71" name="__codelineno-13-71"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"http://www.webloadmpstore.com/cart.php"</span><span class="p">)</span>
</span><span id="__span-13-72"><a href="#__codelineno-13-72" id="__codelineno-13-72" name="__codelineno-13-72"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-13-73"><a href="#__codelineno-13-73" id="__codelineno-13-73" name="__codelineno-13-73"></a>
</span><span id="__span-13-74"><a href="#__codelineno-13-74" id="__codelineno-13-74" name="__codelineno-13-74"></a><span class="cm">/***** WLIDE - URL : HTTPS - ID:22 *****/</span><span class="w"> </span>
</span><span id="__span-13-75"><a href="#__codelineno-13-75" id="__codelineno-13-75" name="__codelineno-13-75"></a><span class="nx">wlGlobals</span><span class="p">.</span><span class="nx">GetFrames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span>
</span><span id="__span-13-76"><a href="#__codelineno-13-76" id="__codelineno-13-76" name="__codelineno-13-76"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span>
</span><span id="__span-13-77"><a href="#__codelineno-13-77" id="__codelineno-13-77" name="__codelineno-13-77"></a><span class="s2">"http://www.webloadmpstore.com/cart.php?event=update&amp;id=2&amp;quantity=3"</span>
</span><span id="__span-13-78"><a href="#__codelineno-13-78" id="__codelineno-13-78" name="__codelineno-13-78"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"https://www.webloadmpstore.com/checkout.php"</span><span class="p">)</span>
</span><span id="__span-13-79"><a href="#__codelineno-13-79" id="__codelineno-13-79" name="__codelineno-13-79"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-13-80"><a href="#__codelineno-13-80" id="__codelineno-13-80" name="__codelineno-13-80"></a>
</span><span id="__span-13-81"><a href="#__codelineno-13-81" id="__codelineno-13-81" name="__codelineno-13-81"></a><span class="cm">/***** WLIDE - URL : https://www.webloadmpstore.com/soap/server.php?wsdl - ID:23 *****/</span>
</span><span id="__span-13-82"><a href="#__codelineno-13-82" id="__codelineno-13-82" name="__codelineno-13-82"></a><span class="nx">wlGlobals</span><span class="p">.</span><span class="nx">GetFrames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
</span><span id="__span-13-83"><a href="#__codelineno-13-83" id="__codelineno-13-83" name="__codelineno-13-83"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"https://www.webloadmpstore.com/checkout.php"</span>
</span><span id="__span-13-84"><a href="#__codelineno-13-84" id="__codelineno-13-84" name="__codelineno-13-84"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"wsdl"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"$WL$VOID$STRING$"</span><span class="w"> </span>
</span><span id="__span-13-85"><a href="#__codelineno-13-85" id="__codelineno-13-85" name="__codelineno-13-85"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"https://www.webloadmpstore.com/soap/server.php"</span><span class="p">)</span>
</span><span id="__span-13-86"><a href="#__codelineno-13-86" id="__codelineno-13-86" name="__codelineno-13-86"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-13-87"><a href="#__codelineno-13-87" id="__codelineno-13-87" name="__codelineno-13-87"></a>
</span><span id="__span-13-88"><a href="#__codelineno-13-88" id="__codelineno-13-88" name="__codelineno-13-88"></a><span class="cm">/***** WLIDE - URL : Validate Cred - Pass - ID:26 *****/</span>
</span><span id="__span-13-89"><a href="#__codelineno-13-89" id="__codelineno-13-89" name="__codelineno-13-89"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span>
</span><span id="__span-13-90"><a href="#__codelineno-13-90" id="__codelineno-13-90" name="__codelineno-13-90"></a><span class="s2">"https://www.webloadmpstore.com/checkout.php"</span>
</span><span id="__span-13-91"><a href="#__codelineno-13-91" id="__codelineno-13-91" name="__codelineno-13-91"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Data</span><span class="p">[</span><span class="s2">"Type"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"text/xml; charset=utf-8"</span>
</span><span id="__span-13-92"><a href="#__codelineno-13-92" id="__codelineno-13-92" name="__codelineno-13-92"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Data</span><span class="p">[</span><span class="s2">"Value"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"&lt;?xml version=\"1.0\" encoding=\"utf8\"?&gt;&lt;soap:Envelope</span>
</span><span id="__span-13-93"><a href="#__codelineno-13-93" id="__codelineno-13-93" name="__codelineno-13-93"></a><span class="s2">xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"</span>
</span><span id="__span-13-94"><a href="#__codelineno-13-94" id="__codelineno-13-94" name="__codelineno-13-94"></a><span class="s2">xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"</span>
</span><span id="__span-13-95"><a href="#__codelineno-13-95" id="__codelineno-13-95" name="__codelineno-13-95"></a><span class="s2">xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;&lt;soap:B</span>
</span><span id="__span-13-96"><a href="#__codelineno-13-96" id="__codelineno-13-96" name="__codelineno-13-96"></a><span class="s2">ody&gt;&lt;checkValidity</span>
</span><span id="__span-13-97"><a href="#__codelineno-13-97" id="__codelineno-13-97" name="__codelineno-13-97"></a><span class="s2">xmlns=\"http://example.org/CreditCardProcess\"&gt;&lt;strCardNumber&gt;AB</span>
</span><span id="__span-13-98"><a href="#__codelineno-13-98" id="__codelineno-13-98" name="__codelineno-13-98"></a><span class="s2">CD&lt;/strCardNumber&gt;&lt;strHolderID&gt;AB1234&lt;/strHolderID&gt;&lt;/checkValidi</span>
</span><span id="__span-13-99"><a href="#__codelineno-13-99" id="__codelineno-13-99" name="__codelineno-13-99"></a><span class="s2">ty&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;"</span>
</span><span id="__span-13-100"><a href="#__codelineno-13-100" id="__codelineno-13-100" name="__codelineno-13-100"></a>
</span><span id="__span-13-101"><a href="#__codelineno-13-101" id="__codelineno-13-101" name="__codelineno-13-101"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Post</span><span class="p">(</span><span class="s2">"https://www.webloadmpstore.com/soap/server.php"</span><span class="p">)</span>
</span><span id="__span-13-102"><a href="#__codelineno-13-102" id="__codelineno-13-102" name="__codelineno-13-102"></a>
</span><span id="__span-13-103"><a href="#__codelineno-13-103" id="__codelineno-13-103" name="__codelineno-13-103"></a><span class="nx">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">resultParser</span><span class="p">(</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">wlXmls</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-13-104"><a href="#__codelineno-13-104" id="__codelineno-13-104" name="__codelineno-13-104"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">results</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"1"</span><span class="p">)</span>
</span><span id="__span-13-105"><a href="#__codelineno-13-105" id="__codelineno-13-105" name="__codelineno-13-105"></a><span class="w">    </span><span class="nx">InfoMessage</span><span class="p">(</span><span class="s2">"Validation check return ‘Check OK’ like it should"</span><span class="p">)</span>
</span><span id="__span-13-106"><a href="#__codelineno-13-106" id="__codelineno-13-106" name="__codelineno-13-106"></a><span class="k">else</span>
</span><span id="__span-13-107"><a href="#__codelineno-13-107" id="__codelineno-13-107" name="__codelineno-13-107"></a><span class="w">    </span><span class="nx">InfoMessage</span><span class="p">(</span><span class="s2">"Validation check is not working correctly"</span><span class="p">)</span>
</span><span id="__span-13-108"><a href="#__codelineno-13-108" id="__codelineno-13-108" name="__codelineno-13-108"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-13-109"><a href="#__codelineno-13-109" id="__codelineno-13-109" name="__codelineno-13-109"></a>
</span><span id="__span-13-110"><a href="#__codelineno-13-110" id="__codelineno-13-110" name="__codelineno-13-110"></a><span class="cm">/***** WLIDE - URL : Confirm Order - ID:27 *****/</span>
</span><span id="__span-13-111"><a href="#__codelineno-13-111" id="__codelineno-13-111" name="__codelineno-13-111"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">ContentType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"application/x-www-form-urlencoded"</span>
</span><span id="__span-13-112"><a href="#__codelineno-13-112" id="__codelineno-13-112" name="__codelineno-13-112"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"name"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Radview"</span>
</span><span id="__span-13-113"><a href="#__codelineno-13-113" id="__codelineno-13-113" name="__codelineno-13-113"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"address"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Hamelacha 14"</span>
</span><span id="__span-13-114"><a href="#__codelineno-13-114" id="__codelineno-13-114" name="__codelineno-13-114"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"shippingAddress"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Park Afek"</span>
</span><span id="__span-13-115"><a href="#__codelineno-13-115" id="__codelineno-13-115" name="__codelineno-13-115"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"cardNumber"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ABCD"</span>
</span><span id="__span-13-116"><a href="#__codelineno-13-116" id="__codelineno-13-116" name="__codelineno-13-116"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"idNumber"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"AB1234"</span>
</span><span id="__span-13-117"><a href="#__codelineno-13-117" id="__codelineno-13-117" name="__codelineno-13-117"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"event"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"process"</span>
</span><span id="__span-13-118"><a href="#__codelineno-13-118" id="__codelineno-13-118" name="__codelineno-13-118"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Post</span><span class="p">(</span><span class="s2">"https://www.webloadmpstore.com/checkout.php"</span><span class="p">)</span>
</span><span id="__span-13-119"><a href="#__codelineno-13-119" id="__codelineno-13-119" name="__codelineno-13-119"></a><span class="c1">// END WLIDE</span>
</span></code></pre></div>
<h2 id="scripting-sample-using-ajax-and-json-to-validate-a-web-server-response">Scripting Sample Using AJAX and JSON to Validate a Web Server Response</h2>
<p>WebLOAD supports automatic recording of AJAX calls into the test script using JSON, enabling debugging and full access to all request data (headers and body), both in the script and during runtime.</p>
<h3 id="what-the-script-does_2">What the Script Does</h3>
<ul>
<li>Demonstrates how WebLOAD supports AJAX and JSON.</li>
<li>Demonstrates how to validate a Web service response.</li>
</ul>
<h3 id="how-the-script-works">How the Script Works</h3>
<p>In this script, you will search for a product in the webloadmpstore site and in the search results page, you will request to see the site’s statistics. The statistics displayed include the number of users online and the date and time. These statistics are updated every ten seconds to ensure their accuracy by using an asynchronous AJAX call. Each time the information is updated, the AJAX script is recorded in the script by WebLOAD Recorder.</p>
<p>The following steps demonstrate how to modify the AJAX script so that the WebLOAD Recorder displays the JSON information in the log view during runtime. This is done by adding an InfoMessage to the script, which displays the information based on the JSON response.</p>
<h4 id="step-1-recording-ajax-calls-in-the-script">Step 1 – Recording AJAX Calls in the script</h4>
<ol>
<li>
<p>Start recording a new script and browse to <a href="http://www.webloadmpstore.com/">www.webloadmpstore.com.</a> The script is recorded as follows: </p>
<p><code>wlGlobals.GetFrames = false</code></p>
<p><code>wlHttp.Get("http://www.webloadmpstore.com/index.php")</code></p>
</li>
<li>
<p>In the webloadmpstore website, enter WebLOAD in the Search field and click <strong>SEARCH</strong>. </p>
<p>The search results for WebLOAD appear. In the IDE the following script is recorded: </p>
<p><code>wlHttp.Header["Referer"] = "http://www.webloadmpstore.com/index.php"</code>
<code>wlHttp.ContentType = "application/x-www-form-urlencoded"</code>
<code>wlHttp.FormData["event"] = "search"</code>
<code>wlHttp.FormData["searchTerm"] = "webload"</code>
<code>wlHttp.Post("http://www.webloadmpstore.com/search.php")</code></p>
</li>
<li>
<p>Check the <strong>Show statistics</strong> checkbox. The script in the script appears as follows:</p>
<p><code>wlHttp.Header["Referer"] = "http://www.webloadmpstore.com/search.php"</code>
<code>wlHttp.Get("http://www.webloadmpstore.com/usersonlinecounter.php")</code></p>
<p>New nodes are recorded repeatedly and added to the script as the site automatically refreshes itself every ten seconds.</p>
</li>
<li>
<p>After a few nodes have been added to the script, click <img alt="" src="../../images/script_guide_120.jpeg"/> in WebLOAD Recorder to stop recording the script.</p>
</li>
</ol>
<h4 id="step-2-parsing-the-json-response">Step 2 – Parsing the JSON Response</h4>
<ol>
<li>
<p>In the <code>InitAgenda()</code> function in the script, define the global variable values of the <code>SaveSource</code> property as follows:</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-14-1"><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">InitAgenda</span><span class="p">()</span>
</span><span id="__span-14-2"><a href="#__codelineno-14-2" id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="p">{</span>
</span><span id="__span-14-3"><a href="#__codelineno-14-3" id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="nx">wlGlobals</span><span class="p">.</span><span class="nx">SaveSource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</span><span id="__span-14-4"><a href="#__codelineno-14-4" id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="p">}</span>
</span></code></pre></div>
<p>This instructs WebLOAD to store the complete HTML source code downloaded in the <code>document.wlSource</code> object.</p>
</li>
<li>
<p>Drag the JavaScript object Building Block from the Toolbox to the Script Tree. In the Building Block, add a function that receives the <code>document.wlSource</code> object and manipulates it to retrieve the statistics. The script is as follows:</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-15-1"><a href="#__codelineno-15-1" id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">evalResponse</span><span class="w"> </span><span class="p">(</span><span class="nx">source</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-2"><a href="#__codelineno-15-2" id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="nx">json</span><span class="err">\</span><span class="nx">_response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">eval</span><span class="p">(</span><span class="s2">"("</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">source</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">")"</span><span class="p">)</span>
</span><span id="__span-15-3"><a href="#__codelineno-15-3" id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="p">}</span>
</span></code></pre></div>
</li>
<li>
<p>Create an <code>InfoMessage</code> to notify you of the statistic values during runtime. The edited script is as follows:</p>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-16-1"><a href="#__codelineno-16-1" id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">evalResponse</span><span class="w"> </span><span class="p">(</span><span class="nx">source</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
</span><span id="__span-16-2"><a href="#__codelineno-16-2" id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="w">    </span><span class="nx">json</span><span class="err">\</span><span class="nx">_response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">eval</span><span class="p">(</span><span class="s2">"("</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">source</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">")"</span><span class="p">)</span>
</span><span id="__span-16-3"><a href="#__codelineno-16-3" id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="nx">InfoMessage</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="s2">"The number of online users is: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">json</span><span class="err">\</span><span class="nx">_response</span><span class="p">.</span><span class="nx">usersOnline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" and The current time is: "</span>
</span><span id="__span-16-4"><a href="#__codelineno-16-4" id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="o">+</span><span class="w"> </span><span class="nx">json</span><span class="err">\</span><span class="nx">_response</span><span class="p">.</span><span class="nx">time</span><span class="p">)</span><span class="w"> </span>
</span><span id="__span-16-5"><a href="#__codelineno-16-5" id="__codelineno-16-5" name="__codelineno-16-5"></a><span class="p">}</span>
</span></code></pre></div>
</li>
<li>
<p>In each of the AJAX calls recorded in the script, add a call to the newly created function:</p>
<p><code>wlHttp.Header["Referer"] = "http://www.webloadmpstore.com/search.php"</code></p>
<p><code>wlHttp.Get("http://www.webloadmpstore.com/usersonlinecounter.php")</code></p>
<p><code>evalResponse(document.wlSource)</code> </p>
</li>
<li>
<p>Save the script as script 5-AJAX and JSON.</p>
</li>
</ol>
<h4 id="step-3-displaying-json-information-during-runtime">Step 3 – Displaying JSON Information During Runtime</h4>
<p>Run the script. Each time the browser refreshes itself, a message in the log view is displayed. The message contains the statistics recorded in the browser, including the time and number of users online:</p>
<p><code>The number of online users is: 1 and The current time is: 11:23:11am</code></p>
<h3 id="the-full-script-script-5-ajax-and-json">The Full script: script 5-AJAX and JSON</h3>
<div class="language-javascript highlight"><pre><span></span><code><span id="__span-17-1"><a href="#__codelineno-17-1" id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="kd">function</span><span class="w"> </span><span class="nx">InitAgenda</span><span class="p">()</span>
</span><span id="__span-17-2"><a href="#__codelineno-17-2" id="__codelineno-17-2" name="__codelineno-17-2"></a>
</span><span id="__span-17-3"><a href="#__codelineno-17-3" id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="p">{</span>
</span><span id="__span-17-4"><a href="#__codelineno-17-4" id="__codelineno-17-4" name="__codelineno-17-4"></a>
</span><span id="__span-17-5"><a href="#__codelineno-17-5" id="__codelineno-17-5" name="__codelineno-17-5"></a><span class="nx">wlGlobals</span><span class="p">.</span><span class="nx">SaveSource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</span><span id="__span-17-6"><a href="#__codelineno-17-6" id="__codelineno-17-6" name="__codelineno-17-6"></a>
</span><span id="__span-17-7"><a href="#__codelineno-17-7" id="__codelineno-17-7" name="__codelineno-17-7"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-17-8"><a href="#__codelineno-17-8" id="__codelineno-17-8" name="__codelineno-17-8"></a>
</span><span id="__span-17-9"><a href="#__codelineno-17-9" id="__codelineno-17-9" name="__codelineno-17-9"></a><span class="p">}</span>
</span><span id="__span-17-10"><a href="#__codelineno-17-10" id="__codelineno-17-10" name="__codelineno-17-10"></a>
</span><span id="__span-17-11"><a href="#__codelineno-17-11" id="__codelineno-17-11" name="__codelineno-17-11"></a><span class="sr">/\*\*\*\*\* WLIDE - URL : Home Page - ID:20 \*\*\*\*\*/</span><span class="w"> </span><span class="nx">wlGlobals</span><span class="p">.</span><span class="nx">GetFrames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"&lt;http://www.webloadmpstore.com/index.php&gt;"</span><span class="p">)</span>
</span><span id="__span-17-12"><a href="#__codelineno-17-12" id="__codelineno-17-12" name="__codelineno-17-12"></a>
</span><span id="__span-17-13"><a href="#__codelineno-17-13" id="__codelineno-17-13" name="__codelineno-17-13"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-17-14"><a href="#__codelineno-17-14" id="__codelineno-17-14" name="__codelineno-17-14"></a>
</span><span id="__span-17-15"><a href="#__codelineno-17-15" id="__codelineno-17-15" name="__codelineno-17-15"></a><span class="sr">/\*\*\*\*\* WLIDE - Sleep - ID:22 \*\*\*\*\*/</span><span class="w"> </span><span class="nx">Sleep</span><span class="p">(</span><span class="mf">8371</span><span class="p">)</span>
</span><span id="__span-17-16"><a href="#__codelineno-17-16" id="__codelineno-17-16" name="__codelineno-17-16"></a>
</span><span id="__span-17-17"><a href="#__codelineno-17-17" id="__codelineno-17-17" name="__codelineno-17-17"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-17-18"><a href="#__codelineno-17-18" id="__codelineno-17-18" name="__codelineno-17-18"></a>
</span><span id="__span-17-19"><a href="#__codelineno-17-19" id="__codelineno-17-19" name="__codelineno-17-19"></a><span class="sr">/\*\*\*\*\* WLIDE -Search page - ID:23 \*\*\*\*\*/</span>
</span><span id="__span-17-20"><a href="#__codelineno-17-20" id="__codelineno-17-20" name="__codelineno-17-20"></a>
</span><span id="__span-17-21"><a href="#__codelineno-17-21" id="__codelineno-17-21" name="__codelineno-17-21"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"&lt;http://www.webloadmpstore.com/index.php&gt;"</span>
</span><span id="__span-17-22"><a href="#__codelineno-17-22" id="__codelineno-17-22" name="__codelineno-17-22"></a>
</span><span id="__span-17-23"><a href="#__codelineno-17-23" id="__codelineno-17-23" name="__codelineno-17-23"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">ContentType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"application/x-www-form-urlencoded"</span><span class="w"> </span><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"event"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"search"</span>
</span><span id="__span-17-24"><a href="#__codelineno-17-24" id="__codelineno-17-24" name="__codelineno-17-24"></a>
</span><span id="__span-17-25"><a href="#__codelineno-17-25" id="__codelineno-17-25" name="__codelineno-17-25"></a>
</span><span id="__span-17-26"><a href="#__codelineno-17-26" id="__codelineno-17-26" name="__codelineno-17-26"></a>
</span><span id="__span-17-27"><a href="#__codelineno-17-27" id="__codelineno-17-27" name="__codelineno-17-27"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">FormData</span><span class="p">[</span><span class="s2">"searchTerm"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"webload"</span><span class="w"> </span><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Post</span><span class="p">(</span><span class="s2">"&lt;http://www.webloadmpstore.com/search.php&gt;"</span><span class="p">)</span>
</span><span id="__span-17-28"><a href="#__codelineno-17-28" id="__codelineno-17-28" name="__codelineno-17-28"></a>
</span><span id="__span-17-29"><a href="#__codelineno-17-29" id="__codelineno-17-29" name="__codelineno-17-29"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-17-30"><a href="#__codelineno-17-30" id="__codelineno-17-30" name="__codelineno-17-30"></a>
</span><span id="__span-17-31"><a href="#__codelineno-17-31" id="__codelineno-17-31" name="__codelineno-17-31"></a><span class="sr">/\*\*\*\*\* WLIDE - Sleep - ID:24 \*\*\*\*\*/</span><span class="w"> </span><span class="nx">Sleep</span><span class="p">(</span><span class="mf">8542</span><span class="p">)</span>
</span><span id="__span-17-32"><a href="#__codelineno-17-32" id="__codelineno-17-32" name="__codelineno-17-32"></a>
</span><span id="__span-17-33"><a href="#__codelineno-17-33" id="__codelineno-17-33" name="__codelineno-17-33"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-17-34"><a href="#__codelineno-17-34" id="__codelineno-17-34" name="__codelineno-17-34"></a>
</span><span id="__span-17-35"><a href="#__codelineno-17-35" id="__codelineno-17-35" name="__codelineno-17-35"></a><span class="sr">/\*\*\*\*\* WLIDE - JavaScriptObject - ID:27 \*\*\*\*\*/</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">evalResponse</span><span class="w"> </span><span class="p">(</span><span class="nx">source</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-36"><a href="#__codelineno-17-36" id="__codelineno-17-36" name="__codelineno-17-36"></a>
</span><span id="__span-17-37"><a href="#__codelineno-17-37" id="__codelineno-17-37" name="__codelineno-17-37"></a><span class="nx">json</span><span class="err">\</span><span class="nx">_response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">eval</span><span class="p">(</span><span class="s2">"("</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">source</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">")"</span><span class="p">)</span>
</span><span id="__span-17-38"><a href="#__codelineno-17-38" id="__codelineno-17-38" name="__codelineno-17-38"></a>
</span><span id="__span-17-39"><a href="#__codelineno-17-39" id="__codelineno-17-39" name="__codelineno-17-39"></a><span class="nx">InfoMessage</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="s2">"The number of online users is: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">json</span><span class="err">\</span><span class="nx">_response</span><span class="p">.</span><span class="nx">usersOnline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" and The current time is: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">json</span><span class="err">\</span><span class="nx">_response</span><span class="p">.</span><span class="nx">time</span><span class="p">)</span>
</span><span id="__span-17-40"><a href="#__codelineno-17-40" id="__codelineno-17-40" name="__codelineno-17-40"></a>
</span><span id="__span-17-41"><a href="#__codelineno-17-41" id="__codelineno-17-41" name="__codelineno-17-41"></a><span class="p">}</span>
</span><span id="__span-17-42"><a href="#__codelineno-17-42" id="__codelineno-17-42" name="__codelineno-17-42"></a>
</span><span id="__span-17-43"><a href="#__codelineno-17-43" id="__codelineno-17-43" name="__codelineno-17-43"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-17-44"><a href="#__codelineno-17-44" id="__codelineno-17-44" name="__codelineno-17-44"></a>
</span><span id="__span-17-45"><a href="#__codelineno-17-45" id="__codelineno-17-45" name="__codelineno-17-45"></a><span class="sr">/\*\*\*\*\* WLIDE - URL : Ajax - ID:7 \*\*\*\*\*/</span>
</span><span id="__span-17-46"><a href="#__codelineno-17-46" id="__codelineno-17-46" name="__codelineno-17-46"></a>
</span><span id="__span-17-47"><a href="#__codelineno-17-47" id="__codelineno-17-47" name="__codelineno-17-47"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"&lt;http://www.webloadmpstore.com/search.php&gt;"</span>
</span><span id="__span-17-48"><a href="#__codelineno-17-48" id="__codelineno-17-48" name="__codelineno-17-48"></a>
</span><span id="__span-17-49"><a href="#__codelineno-17-49" id="__codelineno-17-49" name="__codelineno-17-49"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"&lt;http://www.webloadmpstore.com/usersonlinecounter.php&gt; "</span><span class="p">)</span>
</span><span id="__span-17-50"><a href="#__codelineno-17-50" id="__codelineno-17-50" name="__codelineno-17-50"></a>
</span><span id="__span-17-51"><a href="#__codelineno-17-51" id="__codelineno-17-51" name="__codelineno-17-51"></a><span class="nx">evalResponse</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">wlSource</span><span class="p">)</span>
</span><span id="__span-17-52"><a href="#__codelineno-17-52" id="__codelineno-17-52" name="__codelineno-17-52"></a>
</span><span id="__span-17-53"><a href="#__codelineno-17-53" id="__codelineno-17-53" name="__codelineno-17-53"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-17-54"><a href="#__codelineno-17-54" id="__codelineno-17-54" name="__codelineno-17-54"></a>
</span><span id="__span-17-55"><a href="#__codelineno-17-55" id="__codelineno-17-55" name="__codelineno-17-55"></a><span class="sr">/\*\*\*\*\* WLIDE - Sleep - ID:8 \*\*\*\*\*/</span><span class="w"> </span><span class="nx">Sleep</span><span class="p">(</span><span class="mf">10811</span><span class="p">)</span>
</span><span id="__span-17-56"><a href="#__codelineno-17-56" id="__codelineno-17-56" name="__codelineno-17-56"></a>
</span><span id="__span-17-57"><a href="#__codelineno-17-57" id="__codelineno-17-57" name="__codelineno-17-57"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-17-58"><a href="#__codelineno-17-58" id="__codelineno-17-58" name="__codelineno-17-58"></a>
</span><span id="__span-17-59"><a href="#__codelineno-17-59" id="__codelineno-17-59" name="__codelineno-17-59"></a><span class="sr">/\*\*\*\*\* WLIDE - URL : Ajax - ID:9 \*\*\*\*\*/</span>
</span><span id="__span-17-60"><a href="#__codelineno-17-60" id="__codelineno-17-60" name="__codelineno-17-60"></a>
</span><span id="__span-17-61"><a href="#__codelineno-17-61" id="__codelineno-17-61" name="__codelineno-17-61"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"&lt;http://www.webloadmpstore.com/search.php&gt;"</span>
</span><span id="__span-17-62"><a href="#__codelineno-17-62" id="__codelineno-17-62" name="__codelineno-17-62"></a>
</span><span id="__span-17-63"><a href="#__codelineno-17-63" id="__codelineno-17-63" name="__codelineno-17-63"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"&lt;http://www.webloadmpstore.com/usersonlinecounter.php&gt; "</span><span class="p">)</span>
</span><span id="__span-17-64"><a href="#__codelineno-17-64" id="__codelineno-17-64" name="__codelineno-17-64"></a>
</span><span id="__span-17-65"><a href="#__codelineno-17-65" id="__codelineno-17-65" name="__codelineno-17-65"></a><span class="nx">evalResponse</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">wlSource</span><span class="p">)</span>
</span><span id="__span-17-66"><a href="#__codelineno-17-66" id="__codelineno-17-66" name="__codelineno-17-66"></a>
</span><span id="__span-17-67"><a href="#__codelineno-17-67" id="__codelineno-17-67" name="__codelineno-17-67"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-17-68"><a href="#__codelineno-17-68" id="__codelineno-17-68" name="__codelineno-17-68"></a>
</span><span id="__span-17-69"><a href="#__codelineno-17-69" id="__codelineno-17-69" name="__codelineno-17-69"></a><span class="sr">/\*\*\*\*\* WLIDE - Sleep - ID:10 \*\*\*\*\*/</span><span class="w"> </span><span class="nx">Sleep</span><span class="p">(</span><span class="mf">10640</span><span class="p">)</span>
</span><span id="__span-17-70"><a href="#__codelineno-17-70" id="__codelineno-17-70" name="__codelineno-17-70"></a>
</span><span id="__span-17-71"><a href="#__codelineno-17-71" id="__codelineno-17-71" name="__codelineno-17-71"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-17-72"><a href="#__codelineno-17-72" id="__codelineno-17-72" name="__codelineno-17-72"></a>
</span><span id="__span-17-73"><a href="#__codelineno-17-73" id="__codelineno-17-73" name="__codelineno-17-73"></a>
</span><span id="__span-17-74"><a href="#__codelineno-17-74" id="__codelineno-17-74" name="__codelineno-17-74"></a>
</span><span id="__span-17-75"><a href="#__codelineno-17-75" id="__codelineno-17-75" name="__codelineno-17-75"></a>
</span><span id="__span-17-76"><a href="#__codelineno-17-76" id="__codelineno-17-76" name="__codelineno-17-76"></a>
</span><span id="__span-17-77"><a href="#__codelineno-17-77" id="__codelineno-17-77" name="__codelineno-17-77"></a><span class="sr">/\*\*\*\*\* WLIDE - URL : Ajax - ID:11 \*\*\*\*\*/</span>
</span><span id="__span-17-78"><a href="#__codelineno-17-78" id="__codelineno-17-78" name="__codelineno-17-78"></a>
</span><span id="__span-17-79"><a href="#__codelineno-17-79" id="__codelineno-17-79" name="__codelineno-17-79"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"&lt;http://www.webloadmpstore.com/search.php&gt;"</span>
</span><span id="__span-17-80"><a href="#__codelineno-17-80" id="__codelineno-17-80" name="__codelineno-17-80"></a>
</span><span id="__span-17-81"><a href="#__codelineno-17-81" id="__codelineno-17-81" name="__codelineno-17-81"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"&lt;http://www.webloadmpstore.com/usersonlinecounter.php&gt; "</span><span class="p">)</span>
</span><span id="__span-17-82"><a href="#__codelineno-17-82" id="__codelineno-17-82" name="__codelineno-17-82"></a>
</span><span id="__span-17-83"><a href="#__codelineno-17-83" id="__codelineno-17-83" name="__codelineno-17-83"></a><span class="nx">evalResponse</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">wlSource</span><span class="p">)</span>
</span><span id="__span-17-84"><a href="#__codelineno-17-84" id="__codelineno-17-84" name="__codelineno-17-84"></a>
</span><span id="__span-17-85"><a href="#__codelineno-17-85" id="__codelineno-17-85" name="__codelineno-17-85"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-17-86"><a href="#__codelineno-17-86" id="__codelineno-17-86" name="__codelineno-17-86"></a>
</span><span id="__span-17-87"><a href="#__codelineno-17-87" id="__codelineno-17-87" name="__codelineno-17-87"></a><span class="sr">/\*\*\*\*\* WLIDE - Sleep - ID:12 \*\*\*\*\*/</span><span class="w"> </span><span class="nx">Sleep</span><span class="p">(</span><span class="mf">10655</span><span class="p">)</span>
</span><span id="__span-17-88"><a href="#__codelineno-17-88" id="__codelineno-17-88" name="__codelineno-17-88"></a>
</span><span id="__span-17-89"><a href="#__codelineno-17-89" id="__codelineno-17-89" name="__codelineno-17-89"></a><span class="c1">// END WLIDE</span>
</span><span id="__span-17-90"><a href="#__codelineno-17-90" id="__codelineno-17-90" name="__codelineno-17-90"></a>
</span><span id="__span-17-91"><a href="#__codelineno-17-91" id="__codelineno-17-91" name="__codelineno-17-91"></a><span class="sr">/\*\*\*\*\* WLIDE - URL : Ajax - ID:13 \*\*\*\*\*/</span>
</span><span id="__span-17-92"><a href="#__codelineno-17-92" id="__codelineno-17-92" name="__codelineno-17-92"></a>
</span><span id="__span-17-93"><a href="#__codelineno-17-93" id="__codelineno-17-93" name="__codelineno-17-93"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s2">"Referer"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"&lt;http://www.webloadmpstore.com/search.php&gt;"</span>
</span><span id="__span-17-94"><a href="#__codelineno-17-94" id="__codelineno-17-94" name="__codelineno-17-94"></a>
</span><span id="__span-17-95"><a href="#__codelineno-17-95" id="__codelineno-17-95" name="__codelineno-17-95"></a><span class="nx">wlHttp</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="s2">"&lt;http://www.webloadmpstore.com/usersonlinecounter.php&gt; "</span><span class="p">)</span>
</span><span id="__span-17-96"><a href="#__codelineno-17-96" id="__codelineno-17-96" name="__codelineno-17-96"></a>
</span><span id="__span-17-97"><a href="#__codelineno-17-97" id="__codelineno-17-97" name="__codelineno-17-97"></a><span class="nx">evalResponse</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">wlSource</span><span class="p">)</span>
</span><span id="__span-17-98"><a href="#__codelineno-17-98" id="__codelineno-17-98" name="__codelineno-17-98"></a>
</span><span id="__span-17-99"><a href="#__codelineno-17-99" id="__codelineno-17-99" name="__codelineno-17-99"></a><span class="c1">// END WLIDE</span>
</span></code></pre></div>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.instant", "navigation.sections"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
<script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
<script>document$.subscribe(() => {
            window.update_swagger_ui_iframe_height = function (id) {
                var iFrameID = document.getElementById(id);
                if (iFrameID) {
                    full_height = (iFrameID.contentWindow.document.body.scrollHeight + 80) + "px";
                    iFrameID.height = full_height;
                    iFrameID.style.height = full_height;
                }
            }
        
            let iframe_id_list = []
            var iframes = document.getElementsByClassName("swagger-ui-iframe");
            for (var i = 0; i < iframes.length; i++) { 
                iframe_id_list.push(iframes[i].getAttribute("id"))
            }
        
            let ticking = true;
            
            document.addEventListener('scroll', function(e) {
                if (!ticking) {
                    window.requestAnimationFrame(()=> {
                        let half_vh = window.innerHeight/2;
                        for(var i = 0; i < iframe_id_list.length; i++) {
                            let element = document.getElementById(iframe_id_list[i])
                            if(element==null){
                                return
                            }
                            let diff = element.getBoundingClientRect().top
                            if(element.contentWindow.update_top_val){
                                element.contentWindow.update_top_val(half_vh - diff)
                            }
                        }
                        ticking = false;
                    });
                    ticking = true;
                }
            });
        
            const dark_scheme_name = "slate"
            
            window.scheme = document.body.getAttribute("data-md-color-scheme")
            const options = {
                attributeFilter: ['data-md-color-scheme'],
            };
            function color_scheme_callback(mutations) {
                for (let mutation of mutations) {
                    if (mutation.attributeName === "data-md-color-scheme") {
                        scheme = document.body.getAttribute("data-md-color-scheme")
                        var iframe_list = document.getElementsByClassName("swagger-ui-iframe")
                        for(var i = 0; i < iframe_list.length; i++) {
                            var ele = iframe_list.item(i);
                            if (ele) {
                                if (scheme === dark_scheme_name) {
                                    ele.contentWindow.enable_dark_mode();
                                } else {
                                    ele.contentWindow.disable_dark_mode();
                                }
                            }
                        }
                    }
                }
            }
            observer = new MutationObserver(color_scheme_callback);
            observer.observe(document.body, options);
            })</script></body>
</html>